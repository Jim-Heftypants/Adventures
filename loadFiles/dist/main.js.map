{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./loadFiles/src/entities/abilities.js","webpack:///./loadFiles/src/entities/character.js","webpack:///./loadFiles/src/entities/enemy.js","webpack:///./loadFiles/src/entities/entity.js","webpack:///./loadFiles/src/index.js","webpack:///./loadFiles/src/levels/level.js","webpack:///./loadFiles/src/screen_controllers/entity_controller.js","webpack:///./loadFiles/src/screen_controllers/fades.js"],"names":["wordOfHealing","entity","idx","lowest","i","allies","length","hp","Math","floor","dmg","baseHP","setHpBars","setBorder","holySword","tar","abilityShouldCast","ali","target","diff","imgName","dist","sqrt","pow","pos","tempHP","defense","allied","baseDMG","autoAttack","killEntity","div","drawLine","container","offsetWidth","offsetHeight","maxTime","as","setTimeout","remove","console","log","klass","groupHeal","setOverlay","protection","checkAbilityPossible","armor","overlay","document","createElement","classList","add","getElementById","appendChild","style","backgroundColor","top","left","width","img","height","timeCount","timer","setInterval","clearInterval","powerSwing","ceil","stunned","src","baseImg","imgCycle","charge","lockedIntoAbility","ms","trackTarget","inter","display","poisonDagger","slowed","baseMS","int","backstab","transform","meteor","fireblastDiv","opacity","spellTrack","causeAoEEffect","freeze","enemies","rooted","ice","color","border","warriorAbilities","clericAbilities","wizardAbilities","rogueAbilities","paladinAbilities","berserkerAbilities","bardAbilities","rangerAbilities","warlockAbilities","allAbilities","abNum","infiniteRange","withinAttackRange","getElementsByClassName","lightningAutoAttack","specialAttackEffects","knockbackTarget","distance","dX","dY","hypotenuse","xRatio","yRatio","xRight","yDown","targetCenter","topLeft1","leftSetback","topSetback","position","background","zIndex","imagesTouching","imageInside","sizes1","topLeft2","sizes2","imagesTochingSide","createLineElement","x","y","angle","styles","setAttribute","x1","y1","x2","y2","a","b","c","sx","sy","alpha","PI","atan2","action","changedPos","slice","targetImg","interval","move","parseInt","replace","targetPos","posChange","vectorToScalar","endPos","deltaX","deltaY","abs","xChange","yChange","abilityList","Object","values","abilityObj","charAbilities","waAbNames","clAbNames","wiAbNames","roAbNames","paAbNames","beAbNames","baAbNames","raAbNames","wlAbNames","wizardAttackEffect","Warrior","classCreator","Paladin","Cleric","Wizard","Rogue","charactersArr","tutorialWizard","ghettoWizard","wizard2","wizard3","EWizard","tutorialCleric","dumbCleric","cleric2","cleric3","ECleric","tutorialRogue","loserRogue","rogue2","rogue3","ERogue","punchingBag","tutorialWarrior","weakWarrior","warrior2","warrior3","EWarrior","EPaladin","intro","healIntro","rangedIntro","puttinItAllTogetha","ezDoppelganger","level3","level2","doppelganger","allEnemies","Entity","range","attackSpeed","attackDMG","hasAttackOverlay","extraAttackAnimation","abilities","abilityNames","trueBaseHp","basePos","baseAS","trueBaseDMG","trueBaseDefense","baseDefense","level","nextLevelXP","xp","abilityAvailable","abilityContainer","hotkeyDisplay","hotkey","attackImages","moveImages","hpContainerLeft","hpContainerRight","attackOverlay","currentAction","currentAnimation","isAttacking","isMoving","feared","movingOutTheWay","observer","xpObserver","observationToken","entityContainer","id","hpBar","leftBar","innerLeftBar","innerTempBar","rightBar","expBar","value","innerHTML","levelUpDisp","fastFadeOut","numRepeats","attackOnFinish","addXPBar","lockedIn","clearIntervals","bigDiv","frame","self","widthAddition","heightAddition","leftWidth","rightWidth","rightInnerWidth","leftInnerWidth","shuffle","difference","window","innerWidth","checker","setTargetAndAttack","movePos","targetChar","substr","clearTime","iterations","opSubtraction","timeCheck","stackInterval","useAbility","animateAttack","j","attack","newTarg","charactersStacked","eWidthAddition","eHeightAddition","beginAttack","n","ab","cdTime","innerBoxes","colorFade","CDTimer","element","time","start","end","toString","currentColor","numIntervals","deltaZ","random","op","timerDown","fastFadeIn","timerUp","db","addEventListener","event","firebase","firestore","slowFade","dispLevelsScreenMessage","dispHeroesScreenMessage","gameTag","charsDisp","closeButton","hButtons","hButton","keybindContainer","levelButtonContainer","levelButtonHeader","statsContainer","levelButtons","backgroundImage","titleBackground","gameContainer","partySelectorContainer","storyContainer","topRightAuthContainer","authButtonsContainer","loginButton","signupButton","authShader","authInputContainer","authSubmitButton","authInputs","signedInDisplay","setDefaultSaveProfile","userId","dispName","userDoc","collection","doc","set","name","characters","party","maxLevelNumber","storyPage","password","then","get","object","data","loadLevel","error","provider","auth","GoogleAuthProvider","signInWithPopup","result","user","uid","displayName","err","defaultsForAuth","username","validSignup","authFailedDisp","update","validDefaults","validLogin","badInputDisp","loginAction","signupAction","e","preventDefault","formType","animateShader","loadElement","shaderInt","shader","screenDescriptions","keybindInputs","handleKeybindInput","input","secondAction","gTContainer","closeAction","cursor","hButtonPartialAction","enemiesList","enemiesObj","enemiesArr","Level","enemyList","message","actionChanges","shouldSetLevels","characterList","setLevel","modP","percent","applyMod","mod","defaultAction","cArr","eArr","tutorialActions","actionFive","actionSix","actionSeven","actionEight","makeRandomLevel","levelNum","el","enemy","push","lev","levelZero","levelOne","levelTwo","levelThree","levelFour","levelFive","levelSix","levelSeven","levelEight","hasBeenLoaded","levelHasEnded","levels","levelsObj","currentLevelNumber","partyIndexes","levelXPGain","selectedChar","countToReach","moveFinishCount","livingEnemies","livingChars","currentAbilityBoxes","hotkeys","currentUserId","statChar1","statChar2","currentShowingAbilityDescription","heroStatcontainer","heroStatsBlocks","heroNameplateSelectors","statSelectorNames","statImages","statAbilities1","statAbilities2","abDescShader","partySelectorButton","partySelectorNames","characterNameDisplays","button","showAbilityDescription","side","num","hero","char","statImg","nameStat","levelStat","hpStat","dmgStat","defenseStat","partyCharSelected","partyCharIdx","addBlueBorder","removeBlueBorder","removeEventListener","updatePartySave","shouldSwap","statCharSelected","swapStatDisp","currentTarget","sideCheck","charIndex","tarId","sideNum","initiateStatSwap","addDeathListener","MutationObserver","mutations","forEach","mutationRecord","en","endGame","createXPObserver","addCharXP","addEntityEvents","cloneArr","selfIndex","splice","deSelect","styleAbilityBox","aBoxes","select","beginCurrentLevel","beginLevelButton","fadeOut","beginLevel","returnToSelectPage","selectChar","selectEnemy","clickEvents","entityName","stopPropagation","keydownEvent","key","abilityClick","arr","setAbilityBoxes","abilityBoxes","initializeGameOpening","deSelectButton","updateUserScreen","createCharSaveObj","charsObj","updateCharObjects","showStoryParts","setScreen","updateMaxLevel","setPartyByIndexes","loadSaveData","saveData","shouldInitWithPresets","levelNumber","shouldRandomizeEnemySpawns","levelNameDisp","levelMessage","fadeIn","setInitialTargets","loadInCharacters","chars","targetIndex","setAvailableAbilities","boxes","setRandomSpawn","checkPositions","positionFound","p1","p2","cPos","cSizes","eSizes","reZeroStats","loadInEntity","boxEntities","addInlineStyle","observerObserve","backgroundImg","setEnemyLevels","abilityHotkey","observe","attributes","attributeFilter","charsList","projectiles","allCharsList","allEnemyList","disconnect","endMoveChars","fadeOutGame","xpObserverObserve","modEndPos","widthExtra","expWords","xpPercent","xpPerC","xpPerInterval","xpInterval","won","theThing","actionIterations","disp","resetGame","levChars","levEnems","prevScreenAvailable","nextScreenAvailable","storyElements","nextScreenButton","prevScreenButton","openPartyScreenButton"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./loadFiles/src/index.js\");\n","//                              Paladin Abiities\r\n\r\nconst wordOfHealing = (entity) => {\r\n    // console.log(entity.allies);\r\n    let idx = 0;\r\n    let lowest = 2000;\r\n    for (let i = 0; i < entity.allies.length; i++) {\r\n        if (entity.allies[i].hp > 0 && entity.allies[i].hp < lowest) {\r\n            lowest = entity.allies[i].hp;\r\n            idx = i;\r\n        }\r\n    }\r\n    // console.log('lowest hp: ', lowest);\r\n    // console.log('idx: ', idx);\r\n    if (entity.hp < lowest) {\r\n        // console.log(entity.klass);\r\n        // console.log('hp: ', entity.hp);\r\n        entity.hp += Math.floor(entity.dmg * 2.5);\r\n        if (entity.hp > entity.baseHP) {\r\n            entity.hp = entity.baseHP;\r\n        }\r\n        entity.setHpBars();\r\n        setBorder(entity, \"green\");\r\n        // console.log('hp: ', entity.hp);\r\n    } else {\r\n        // console.log(entity.allies[idx].klass);\r\n        // console.log('hp: ', entity.allies[idx].hp);\r\n        entity.allies[idx].hp += Math.floor(entity.dmg * 2.5);\r\n        if (entity.allies[idx].hp > entity.allies[idx].baseHP) {\r\n            entity.allies[idx].hp = entity.allies[idx].baseHP;\r\n        }\r\n        entity.allies[idx].setHpBars();\r\n        setBorder(entity.allies[idx], \"green\");\r\n        // console.log('hp: ', entity.allies[idx].hp);\r\n    }\r\n    return 15;\r\n}\r\n\r\nconst holySword = (entity, tar) => {\r\n    if (entity.abilityShouldCast[1] === 1) {\r\n        const ali = entity.target.allies;\r\n        let diff = -1;\r\n        let idx = -1;\r\n        for (let i = 0; i < ali.length; i++) {\r\n            if (ali[i].imgName === tar.imgName || ali[i].hp <= 0) { continue; }\r\n            const dist = Math.floor(Math.sqrt(Math.pow(tar.pos[0] - ali[i].pos[0], 2) + Math.pow(tar.pos[1] - ali[i].pos[1], 2)));\r\n            if (dist > diff) {\r\n                diff = dist\r\n                idx = i;\r\n            }\r\n        }\r\n        if (idx === -1) {\r\n            return;\r\n        }\r\n        if (ali[idx].tempHP > 0) {\r\n            ali[idx].tempHP -= entity.dmg;\r\n            if (ali[idx].tempHP < 0) {\r\n                ali[idx].hp += ali[idx].tempHP;\r\n                ali[idx].tempHP = 0;\r\n            }\r\n        } else {\r\n            ali[idx].hp -= (entity.dmg * 15 / ali[idx].defense);\r\n        }\r\n        if (!ali[idx].allied && entity.allied && ali[idx].baseDMG > 0 && entity.defense > ali[idx].target.defense) {\r\n            ali[idx].target = entity;\r\n            ali[idx].autoAttack(entity);\r\n        }\r\n        ali[idx].setHpBars();\r\n        setBorder(ali[idx], \"red\");\r\n        if (ali[idx].hp <= 0) {\r\n            entity.killEntity(ali[idx]);\r\n        }\r\n        const div = drawLine(tar.pos[0] + tar.container.offsetWidth / 2, tar.pos[1] + tar.container.offsetHeight / 2,\r\n            ali[idx].pos[0] + ali[idx].container.offsetWidth / 2, ali[idx].pos[1] + ali[idx].container.offsetHeight / 2, \"gold\");\r\n        // console.log(ali[idx].klass);\r\n        // console.log(div);\r\n        const maxTime = Math.floor(entity.as / 8);\r\n        setTimeout(() => { div.remove(); }, maxTime);\r\n    } else {\r\n        entity.abilityShouldCast[1] = 1;\r\n        console.log(entity.klass, \" has ab1 === \", entity.abilityShouldCast[1]);\r\n        setTimeout(() => {\r\n            entity.abilityShouldCast[1] = false;\r\n        }, 7500)\r\n        return 20;\r\n    }\r\n}\r\n\r\n//                              Cleric Abilities\r\n\r\nconst groupHeal = (entity) => {\r\n    for (let i = 0; i < entity.allies.length; i++) {\r\n        if (entity.allies[i].hp > 0) {\r\n            entity.allies[i].hp -= entity.dmg * 2;\r\n            if (entity.allies[i].hp > entity.allies[i].baseHP) { entity.allies[i].hp = entity.allies[i].baseHP; }\r\n            entity.setOverlay(entity.allies[i]);\r\n            entity.allies[i].setHpBars();\r\n            setBorder(entity.allies[i], \"green\");\r\n        }\r\n    }\r\n    return 16;\r\n}\r\n\r\nconst protection = (entity, target) => {\r\n    if (!checkAbilityPossible(entity, 1, target)) { return false; }\r\n    target.tempHP -= entity.dmg;\r\n    target.armor -= entity.dmg;\r\n    target.setHpBars();\r\n    let overlay = document.createElement(\"div\");\r\n    overlay.classList.add(\"oval-shape\");\r\n    document.getElementById(\"game-container\").appendChild(overlay);\r\n    overlay.style.backgroundColor = 'blue';\r\n    overlay.style.top = (target.pos[1] + 40) + 'px';\r\n    overlay.style.left = target.pos[0] + 'px';\r\n    overlay.style.width = target.img.width + 'px';\r\n    overlay.style.height = target.img.height + 'px';\r\n    setTimeout(() => {\r\n        target.armor += entity.dmg;\r\n        overlay.remove();\r\n    }, 8000);\r\n    let timeCount = 0;\r\n    let timer = setInterval(() => {\r\n        timeCount += 20;\r\n        overlay.style.top = (target.pos[1] + 40) + 'px';\r\n        overlay.style.left = target.pos[0] + 'px';\r\n        if (timeCount >= 8000) {\r\n            clearInterval(timer);\r\n        }\r\n    }, 20)\r\n    return 20;\r\n}\r\n\r\n//                              Warrior Abilities\r\n\r\nconst powerSwing = (entity, target) => {\r\n    if (!checkAbilityPossible(entity, 0, target)) { return false; }\r\n    target.hp -= Math.ceil(entity.dmg * 1.5);\r\n    // knockbackTarget(entity, 80);\r\n    target.setHpBars();\r\n    target.stunned = true;\r\n    target.img.src = target.baseImg.src;\r\n    target.imgCycle = 0;\r\n    setBorder(target, \"red\");\r\n    if (target.hp <= 0) {\r\n        entity.killEntity(target);\r\n    }\r\n    setTimeout(() => {\r\n        target.stunned = false;\r\n    }, 2000);\r\n    return 12;\r\n}\r\n\r\nconst charge = (entity, target) => {\r\n    if (!checkAbilityPossible(entity, 1, target, true)) { return false; }\r\n    entity.lockedIntoAbility = true;\r\n    entity.ms += 15;\r\n    entity.trackTarget(target, true);\r\n    if (target.baseDMG > 0) {\r\n        target.target = entity;\r\n        target.autoAttack(entity);\r\n    }\r\n    let inter = setInterval(() => {\r\n        if (!entity.lockedIntoAbility) {\r\n            entity.ms -= 15;\r\n            clearInterval(inter);\r\n        }\r\n        if (target.container.style.display === 'none' || target.hp < 0) {\r\n            entity.lockedIntoAbility = false;\r\n            entity.ms -= 15;\r\n            clearInterval(inter);\r\n        }\r\n    }, 40)\r\n    return 10;\r\n}\r\n\r\n//                              Rogue Abilities\r\n\r\nconst poisonDagger = (entity, target) => {\r\n    if (!checkAbilityPossible(entity, 0, target)) { return false; }\r\n    let timer = 0;\r\n    target.slowed = 50;\r\n    target.ms -= Math.floor(target.baseMS / 2);\r\n    let int = setInterval(() => {\r\n        if (!target || target.container.style.display === 'none') {\r\n            clearInterval(int);\r\n            return;\r\n        }\r\n        timer++;\r\n        target.hp -= Math.floor(Math.ceil(entity.dmg * 3) / 6);\r\n        target.setHpBars();\r\n        setBorder(target, \"purple\");\r\n        if (target.hp <= 0) {\r\n            entity.killEntity(target);\r\n            clearInterval(int)\r\n        }\r\n        if (timer > 5) {\r\n            clearInterval(int);\r\n            target.slowed = false;\r\n            target.ms += Math.floor(target.baseMS / 2);\r\n        }\r\n    }, 500)\r\n    return 10;\r\n}\r\n\r\nconst backstab = (entity, target) => {\r\n    if (!checkAbilityPossible(entity, 1, target)) { return false; }\r\n    if (entity.img.style.transform === target.img.style.transform) {\r\n        target.hp -= Math.ceil(entity.dmg * 2);\r\n    } else {\r\n        target.hp -= Math.ceil(entity.dmg * 5);\r\n    }\r\n    target.setHpBars();\r\n    setBorder(target, \"black\");\r\n    if (target.hp <= 0) {\r\n        entity.killEntity(target);\r\n    }\r\n    return 15;\r\n}\r\n\r\n//                              Wizard Abilities\r\n\r\nconst meteor = (entity, target) => {\r\n    if (!checkAbilityPossible(entity, 0, target)) {return false;}\r\n    const fireblastDiv = document.getElementById('firebomb-div');\r\n    fireblastDiv.style.opacity = '70%';\r\n    spellTrack(fireblastDiv, entity, target, (entity, img) => {\r\n        // console.log('entity: ', entity, \" img: \", img);\r\n        img.style.display = 'none';\r\n        causeAoEEffect(entity, 400, 400, target);\r\n    });\r\n    return 14;\r\n}\r\n\r\nconst freeze = (entity, target) => {\r\n    for (let i = 0; i < entity.enemies.length; i++) {\r\n        if (entity.enemies[i].container.style.display !== 'none' && entity.enemies[i].hp > 0) {\r\n            entity.enemies[i].rooted = true;\r\n            entity.enemies[i].ms -= Math.floor(entity.enemies[i].baseMS / 2);\r\n            const ice = document.createElement(\"div\");\r\n            ice.classList.add(\"under-foot\");\r\n            document.getElementById(\"game-container\").appendChild(ice);\r\n            ice.style.top = (entity.enemies[i].pos[1] + entity.enemies[i].container.offsetHeight) + 'px';\r\n            ice.style.left = entity.enemies[i].pos[0] + 'px';\r\n            ice.style.width = entity.enemies[i].img.width + 'px';\r\n            setTimeout(() => {\r\n                entity.enemies[i].rooted = false;\r\n                ice.remove()\r\n            }, 2000)\r\n            setTimeout(() => {\r\n                entity.enemies[i].ms += Math.floor(entity.enemies[i].baseMS / 2);\r\n            }, 6000)\r\n        }\r\n    }\r\n    return 25;\r\n}\r\n\r\n\r\n\r\nfunction setBorder(target, color) {\r\n    if (target && !target.container.style.display === 'none') {\r\n        if (target.img.style.border !== \"5px solid gold\") {\r\n            target.img.style.border = \"4px solid \" + color;\r\n            setTimeout(() => {\r\n                if (target.img.style.border !== \"5px solid gold\") {\r\n                    target.img.style.border = \"none\";\r\n                }\r\n            }, 500);\r\n        }\r\n    }\r\n}\r\n\r\nconst warriorAbilities = [powerSwing, charge];\r\nconst clericAbilities = [groupHeal, protection];\r\nconst wizardAbilities = [meteor, freeze];\r\nconst rogueAbilities = [poisonDagger, backstab];\r\nconst paladinAbilities = [wordOfHealing, holySword];\r\nconst berserkerAbilities = [];\r\nconst bardAbilities = [];\r\nconst rangerAbilities = [];\r\nconst warlockAbilities = [];\r\nexport const allAbilities = [warriorAbilities, clericAbilities, wizardAbilities, rogueAbilities,\r\n                                paladinAbilities, berserkerAbilities, bardAbilities, rangerAbilities, warlockAbilities];\r\n\r\n\r\nfunction checkAbilityPossible(entity, abNum, target, infiniteRange=false) {\r\n    if (target && (infiniteRange || entity.withinAttackRange(target)) && target.hp > 0) {\r\n        return true;\r\n    }\r\n    entity.abilityShouldCast[abNum] = true;\r\n    document.getElementsByClassName(entity.imgName + '-inner-ability-divs')[abNum].style.backgroundColor = 'lawngreen';\r\n    return false;\r\n}\r\n\r\nconst lightningAutoAttack = (entity, target) => {\r\n    let pos = [entity.pos[0] + 30 + entity.img.width / 2, entity.pos[1] + 38];\r\n    if (entity.img.style.transform === \"scaleX(-1)\") {\r\n        pos[0] -= 60\r\n    }\r\n    const div = drawLine(pos[0], pos[1], target.pos[0] + target.img.width/2, target.pos[1] + target.img.height/2, \"purple\");\r\n    const maxTime = Math.floor(entity.as / 8);\r\n    setTimeout(() => { div.remove(); }, maxTime);\r\n}\r\n\r\nexport const specialAttackEffects = [lightningAutoAttack];\r\n\r\nfunction knockbackTarget(entity, distance, target) {\r\n    const dX = target.pos[0] - entity.pos[0];\r\n    const dY = target.pos[1] - entity.pos[1];\r\n    const hypotenuse = Math.sqrt(Math.pow(dX, 2) + Math.pow(dY, 2));\r\n    const xRatio = dX / hypotenuse;\r\n    const yRatio = dY / hypotenuse;\r\n    const xRight = distance * xRatio;\r\n    const yDown = distance * yRatio;\r\n    target.pos[0] += Math.floor(xRight);\r\n    target.pos[1] += Math.floor(yDown);\r\n    target.container.style.left = target.pos[0] + 'px';\r\n    target.container.style.top = target.pos[1] + 'px';\r\n}\r\n\r\nfunction causeAoEEffect(entity, width, height, target) {\r\n    const targetCenter = [target.pos[0] + Math.floor(target.container.offsetWidth / 2),\r\n        target.pos[1] + Math.floor(target.container.offsetHeight/2)];\r\n    const topLeft1 = [targetCenter[0] - Math.floor(width / 2), targetCenter[1] - Math.floor(height / 2)];\r\n    const div = document.createElement(\"div\");\r\n    const leftSetback = (width - target.container.offsetWidth) / 2;\r\n    const topSetback = (height - target.container.offsetHeight) / 2;\r\n    div.style.position = \"absolute\";\r\n    div.style.left = target.pos[0] - leftSetback + 'px';\r\n    div.style.top = target.pos[1] - topSetback + 'px';\r\n    div.style.width = width + \"px\";\r\n    div.style.height = height + \"px\";\r\n    div.style.background = \"red\";\r\n    div.style.zIndex = \"8\";\r\n    document.getElementById(\"game-container\").appendChild(div);\r\n    setTimeout(() => {\r\n        div.remove();\r\n    }, 750);\r\n    for (let i = 0; i < entity.enemies.length; i++) {\r\n        if (entity.enemies[i].container.style.display !== 'none') {\r\n            if (imagesTouching(topLeft1, [width, height], entity.enemies[i].pos, [entity.enemies[i].img.width, entity.enemies[i].img.height])) {\r\n                // console.log('entity hit by fireball: ', entity.enemies[i].klass);\r\n                entity.enemies[i].hp -= Math.ceil(entity.dmg * 1.5);\r\n                entity.enemies[i].setHpBars();\r\n                setBorder(entity.enemies[i], \"red\");\r\n                if (entity.enemies[i].hp <= 0) {\r\n                    entity.killEntity(entity.enemies[i]);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction imageInside(topLeft1, sizes1, topLeft2, sizes2) {\r\n    return (topLeft1[0] > topLeft2[0] && topLeft1[0] + sizes1[0] < topLeft2[0] + sizes2[0]\r\n                && topLeft1[1] > topLeft2[1] && topLeft1[1] + sizes1[1] < topLeft2[1] + sizes2[1]);\r\n}\r\n\r\nfunction imagesTochingSide(topLeft1, sizes1, topLeft2, sizes2, i) {\r\n    return (topLeft1[i] < topLeft2[i] && topLeft1[i] + sizes1[i] > topLeft2[i]\r\n        || topLeft1[i] < topLeft2[i] + sizes2[i] && topLeft1[i] + sizes1[i] > topLeft2[i] + sizes2[i]);\r\n}\r\n\r\nfunction imagesTouching(topLeft1, sizes1, topLeft2, sizes2) {\r\n    for (let i = 0; i < 2; i++) {\r\n        if (!imagesTochingSide(topLeft1, sizes1, topLeft2, sizes2, i)) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\n\r\nfunction createLineElement(x, y, length, angle, color) {\r\n    var styles = 'width: ' + length + 'px; '\r\n        + 'height: 0px; '\r\n        + '-moz-transform: rotate(' + angle + 'rad); '\r\n        + '-webkit-transform: rotate(' + angle + 'rad); '\r\n        + '-o-transform: rotate(' + angle + 'rad); '\r\n        + '-ms-transform: rotate(' + angle + 'rad); '\r\n        + 'position: absolute; '\r\n        + 'top: ' + y + 'px; '\r\n        + 'left: ' + x + 'px; '\r\n        + 'border: 2px solid ' + color + '; ';\r\n    let div = document.createElement(\"div\");\r\n    div.setAttribute('style', styles);\r\n    div.classList.add(\"extra-attack-effect\");\r\n    document.getElementById(\"game-container\").appendChild(div);\r\n    return div;\r\n    \r\n}\r\n\r\nfunction drawLine(x1, y1, x2, y2, color) {\r\n    const a = x1 - x2,\r\n        b = y1 - y2,\r\n        c = Math.sqrt(a * a + b * b);\r\n\r\n    const sx = (x1 + x2) / 2,\r\n        sy = (y1 + y2) / 2;\r\n\r\n    const x = sx - c / 2,\r\n        y = sy;\r\n\r\n    const alpha = Math.PI - Math.atan2(-b, a);\r\n\r\n    return createLineElement(x, y, c, alpha, color);\r\n}\r\n\r\nfunction spellTrack(img, entity, target, action) {\r\n    // console.log('img: ', img, ' entity: ', entity, ' target: ', target);\r\n    const changedPos = entity.pos.slice();\r\n    changedPos[0] += entity.img.width / 2; changedPos[1] += entity.img.height/2;\r\n    img.style.top = Math.floor(changedPos[1]) + 'px';\r\n    img.style.left = Math.floor(changedPos[0]) + 'px';\r\n    img.style.display = '';\r\n    const targetImg = target.img;\r\n    let interval = setInterval(() => move(), 20);\r\n    function move() {\r\n        if (img.style.display === 'none' || target.container.style.display === 'none') {\r\n            clearInterval(interval);\r\n            img.style.display = 'none';\r\n            // console.log('no target to hit with: ', img);\r\n            return;\r\n        }\r\n        const left = parseInt(img.style.left.replace('px', ''), 10);\r\n        const top = parseInt(img.style.top.replace('px', ''), 10);\r\n        if (imageInside([left, top], [img.offsetWidth, img.offsetHeight], target.pos, [targetImg.width, targetImg.height])) {\r\n            // console.log('images touching');\r\n            clearInterval(interval);\r\n            img.style.display = 'none';\r\n            action(entity, img);\r\n        } else {\r\n            const targetPos = target.pos.slice();\r\n            targetPos[0] += targetImg.width/2; targetPos[1] += targetImg.height/2;\r\n            let posChange = vectorToScalar(changedPos, targetPos);\r\n            changedPos[0] += posChange[0]; changedPos[1] += posChange[1];\r\n            img.style.top = Math.floor(changedPos[1]) + 'px';\r\n            img.style.left = Math.floor(changedPos[0]) + 'px';\r\n        }\r\n    }\r\n}\r\n\r\nfunction vectorToScalar(pos, endPos) {\r\n    const ms = 15;\r\n    const deltaX = pos[0] - endPos[0];\r\n    const deltaY = pos[1] - endPos[1];\r\n    if (Math.abs(deltaX) + Math.abs(deltaY) === 0) { return ([0, 0]); }\r\n    let xChange = -1 * ms * (deltaX / (Math.abs(deltaX) + Math.abs(deltaY)));\r\n    let yChange = -1 * ms * (deltaY / (Math.abs(deltaY) + Math.abs(deltaX)));\r\n    if (xChange === 0 || xChange === -0) {\r\n        xChange = 0;\r\n        // const numRepeats = Math.abs(Math.floor(deltaY / yChange)); // not needed for a track system\r\n        return ([xChange, yChange])\r\n    }\r\n    if (yChange === -0) { yChange = 0; }\r\n    // const numRepeats = Math.abs(Math.floor(deltaX / xChange));\r\n    return ([xChange, yChange])\r\n}","import classCreator from './entity';\nimport * as abilityObj from './abilities.js';\n\n// console.log('ab list', abilityObj);\nconst abilityList = Object.values(abilityObj);\n// console.log('ab array list', abilityObj)\n// console.log(abilityList[0]);\nconst charAbilities = abilityList[0];\nconst warriorAbilities = charAbilities[0];\nconst clericAbilities = charAbilities[1];\nconst wizardAbilities = charAbilities[2];\nconst rogueAbilities = charAbilities[3];\nconst paladinAbilities = charAbilities[4];\nconst berserkerAbilities = charAbilities[5];\nconst bardAbilities = charAbilities[6];\nconst rangerAbilities = charAbilities[7];\nconst warlockAbilities = charAbilities[8];\n\nconst waAbNames = ['Concussive Blow', 'Charge'];\nconst clAbNames = ['Prayer of Healing', \"Protection\"];\nconst wiAbNames = ['Fire Bomb', 'Freeze'];\nconst roAbNames = ['Poison Shiv', 'Backstab'];\nconst paAbNames = ['Word of Healing', 'Holy Sword'];\nconst beAbNames = [];\nconst baAbNames = [];\nconst raAbNames = [];\nconst wlAbNames = [];\n\nconst specialAttackEffects = abilityList[1];\nconst wizardAttackEffect = specialAttackEffects[0];\n\n/*\nCharacter names:\nWarrior: Jim\nWizard: Hank\nWarlock: Stache\nCleric: Gyros\n\nBard: Larry\n\n*/\n\n/*\nclassName\nrange\nmaxHP\nMS\nAS\nDMG\ntrue\npos\ndefense\nhasOverlay? 1=self 2=target\nspecialEffect\nab\nabNames\n*/\n\n// tank\nconst Warrior = new classCreator('Warrior', 10, 100, 10, 1000, 10, true, [100, 400], 20, null, null, warriorAbilities, waAbNames);\nconst Paladin = new classCreator('Paladin', 10, 100, 10, 1000, 10, true, [100, 400], 20, null, null, paladinAbilities, paAbNames);\n\n// heals\nconst Cleric = new classCreator('Cleric', 'infinite', 100, 10, 1500, -8, true, [400, 100], 12, 2, null, clericAbilities, clAbNames);\n\n// rdps\nconst Wizard = new classCreator('Wizard', \"infinite\", 100, 10, 2000, 20, true, [100, 100], 14, null, wizardAttackEffect, wizardAbilities, wiAbNames);\n\n// mdps\nconst Rogue = new classCreator(\"Rogue\", 10, 100, 10, 800, 10, true, [900, 500], 16, null, null, rogueAbilities, roAbNames);\n\nconst charactersArr = [Warrior, Cleric, Wizard, Rogue, Paladin];\nexport default charactersArr;","import classCreator from './entity.js';\nimport * as abilityObj from './abilities.js';\n\nconst abilityList = Object.values(abilityObj);\n\nconst specialAttackEffects = abilityList[1];\nconst wizardAttackEffect = specialAttackEffects[0];\n\n/*\nclassName\nrange\nmaxHP\nMS\nAS\nDMG\ntrue\npos\ndefense\nhasOverlay? 1=self 2=target\nspecialEffect\nab\nabNames\n*/\n\n// rdps\nconst tutorialWizard = new classCreator('EWizard', 'infinite', 60, 10, 1500, 7, false, [1000, 600], 8, null, wizardAttackEffect);\nconst ghettoWizard = new classCreator('EWizard', 'infinite', 60, 10, 1500, 12, false, [500, 500], 8, null, wizardAttackEffect);\nconst wizard2 = new classCreator('EWizard', 'infinite', 70, 10, 1500, 13, false, [500, 500], 14, null, wizardAttackEffect);\nconst wizard3 = new classCreator('EWizard', 'infinite', 70, 10, 1500, 13, false, [700, 200], 14, null, wizardAttackEffect); // fix\nconst EWizard = new classCreator('EWizard', 'infinite', 100, 10, 2000, 20, false, [500, 500], 14, null, wizardAttackEffect);\n\n// heals\nconst tutorialCleric = new classCreator('ECleric', 'infinite', 100, 10, 2000, -7, false, [1000, 300], 8, 2)\nconst dumbCleric = new classCreator('ECleric', 'infinite', 100, 10, 2000, -8, false, [1000, 100], 8, 2);\nconst cleric2 = new classCreator('ECleric', 'infinite', 100, 10, 1750, -11, false, [1000, 100], 12, 2);\nconst cleric3 = new classCreator('ECleric', 'infinite', 100, 10, 1750, -11, false, [300, 400], 12, 2);\nconst ECleric = new classCreator('ECleric', 'infinite', 100, 10, 1500, -8, false, [1000, 100], 12, 2);\n\n// mdps\nconst tutorialRogue = new classCreator(\"ERogue\", 10, 80, 10, 1200, 6, false, [700, 200], 14);\nconst loserRogue = new classCreator(\"ERogue\", 10, 80, 10, 1200, 8, false, [700, 200], 14);\nconst rogue2 = new classCreator(\"ERogue\", 10, 80, 10, 1200, 8, false, [700, 200], 14);\nconst rogue3 = new classCreator(\"ERogue\", 10, 80, 10, 1200, 8, false, [500, 500], 14);\nconst ERogue = new classCreator(\"ERogue\", 10, 100, 10, 800, 10, false, [700, 200], 16);\n\n// tank\nconst punchingBag = new classCreator('EWarrior', 10, 50, 10, 1000, 1, false, [650, 500], 20);\nconst tutorialWarrior = new classCreator('EWarrior', 10, 80, 10, 1000, 6, false, [650, 500], 20);\nconst weakWarrior = new classCreator('EWarrior', 10, 80, 10, 1000, 8, false, [300, 400], 20);\nconst warrior2 = new classCreator('EWarrior', 10, 80, 10, 1000, 8, false, [300, 400], 20);\nconst warrior3 = new classCreator('EWarrior', 10, 80, 10, 1000, 8, false, [1000, 100], 20);\nconst EWarrior = new classCreator('EWarrior', 10, 110, 10, 1000, 10, false, [300, 400], 20);\n\n// paladin\nconst EPaladin = new classCreator('EPaladin', 10, 100, 10, 1000, 10, false, [300, 400], 20);\n\n// classCreator\nexport {classCreator};\n\n// level 1\nexport const intro = [punchingBag];\n\n// level 2\nexport const healIntro = [tutorialWarrior, tutorialCleric];\n\n// level 3\nexport const rangedIntro = [tutorialWarrior, tutorialCleric, tutorialWizard];\n\n// level 4\nexport const puttinItAllTogetha = [tutorialWarrior, tutorialCleric, tutorialWizard, tutorialRogue];\n\n// level 5\nexport const ezDoppelganger = [weakWarrior, dumbCleric, ghettoWizard, loserRogue];\n\n// level 6\nexport const level3 = [wizard2, wizard3, cleric2, cleric3];\n\n// level 7\nexport const level2 = [rogue2, rogue3, warrior2, warrior3];\n\n// level 8\nexport const doppelganger = [EWarrior, ECleric, EWizard, ERogue];\n\n// all enemies\nexport const allEnemies = [EWarrior, ECleric, EWizard, ERogue, EPaladin];","class Entity { // this. is selectedChar\n    constructor(klass=\"\", range=0, baseHP=0, ms=0, attackSpeed=0, attackDMG, allied, pos=[0, 0], defense=0,\n            hasAttackOverlay = null, extraAttackAnimation = null, abilities = [], abilityNames = []) {\n        this.klass = klass;\n        this.range = range;\n        this.trueBaseHp = baseHP;\n        this.baseHP = baseHP;\n        this.hp = this.baseHP;\n        this.tempHP = 0;\n        this.baseMS = ms; // speed / time\n        this.ms = this.baseMS;\n        this.allied = allied; // true === player character\n        this.pos = pos;\n        this.basePos = []; this.basePos[0] = pos[0]; this.basePos[1] = pos[1];\n        this.baseAS = attackSpeed;\n        this.as = this.baseAS;\n        this.trueBaseDMG = attackDMG;\n        this.baseDMG = attackDMG;\n        this.dmg = this.baseDMG;\n        this.trueBaseDefense = defense;\n        this.baseDefense = defense\n        this.defense = this.baseDefense;\n        this.level = 1;\n        if (this.allied) {\n            this.nextLevelXP = 100;\n            this.xp = 0;\n        }\n\n        this.allAbilities = abilities;\n        // this.abilities = abilities; // change on pushed ver\n        this.abilities = [];\n        this.abilityNames = abilityNames;\n        this.abilityAvailable = [true, true, true, true];\n        this.abilityShouldCast = [false, false, false, false];\n        this.abilityContainer;\n\n        this.hotkeyDisplay;\n        this.hotkey;\n\n        this.imgName;\n        this.img; // base standing image\n        this.attackImages; // cycle through array of images\n        this.moveImages; // cycle through array of images\n        this.baseImg; // standard stand image\n        this.container;\n        this.hpContainerLeft;\n        this.hpContainerRight;\n\n        this.attackOverlay = hasAttackOverlay;\n\n        this.currentAction;\n        this.currentAnimation;\n        this.imgCycle = 0;\n        this.isAttacking = false;\n        this.isMoving = false;\n        this.extraAttackAnimation = extraAttackAnimation;\n\n        // CC effects\n        this.stunned = false;\n        this.slowed = false;\n        this.rooted = false;\n        this.feared = false;\n\n        this.lockedIntoAbility = false;\n\n        this.target;\n\n        this.allies;\n        this.enemies;\n\n        this.movingOutTheWay = false;\n\n        this.observer;\n        this.xpObserver;\n        this.observationToken = true;\n    }\n\n    addInlineStyle() {\n        const entityContainer = document.createElement(\"div\");\n        entityContainer.classList.add(\"entity-container\");\n        entityContainer.id = this.imgName + '-display';\n        document.getElementById(\"game-container\").appendChild(entityContainer);\n        const hpBar = document.createElement(\"div\");\n        hpBar.classList.add(\"hp-bar-container\");\n        hpBar.id = this.imgName + '-hp-bar';\n        hpBar.style.display = \"flex\";\n        entityContainer.appendChild(hpBar);\n        const leftBar = document.createElement(\"div\");\n        leftBar.classList.add(\"hp-percentage-left\");\n        leftBar.id = this.imgName + '-hp-left';\n        hpBar.appendChild(leftBar);\n        const innerLeftBar = document.createElement(\"div\");\n        innerLeftBar.id = this.imgName + '-inner-leftHP-bar';\n        innerLeftBar.style.width = '100%';\n        if (this.allied) { innerLeftBar.style.backgroundColor = 'blue';\n        } else { innerLeftBar.style.backgroundColor = 'red'; }\n        const innerTempBar = document.createElement(\"div\");\n        innerTempBar.id = this.imgName + '-inner-tempHP-bar';\n        innerTempBar.style.backgroundColor = 'gold';\n        innerTempBar.style.width = '0%';\n        leftBar.appendChild(innerLeftBar);\n        leftBar.appendChild(innerTempBar);\n        const rightBar = document.createElement(\"div\");\n        rightBar.classList.add(\"hp-percentage-right\");\n        rightBar.id = this.imgName + '-hp-right';\n        hpBar.appendChild(rightBar);\n        if (this.allied) {\n            const expBar = document.createElement(\"div\");\n            expBar.classList.add(\"exp-words\");\n            expBar.id = this.imgName + '-exp-words';\n            hpBar.appendChild(expBar);\n        }\n        const img = document.createElement(\"img\");\n        img.classList.add('image-display');\n        img.id = this.imgName + '-image-display';\n        entityContainer.appendChild(img);\n        const hotkeyDisplay = document.createElement(\"p\");\n        hotkeyDisplay.classList.add(\"hotkey-character-display\");\n        hotkeyDisplay.id = this.imgName + 'hotkey-display';\n        entityContainer.appendChild(hotkeyDisplay);\n        this.img = img;\n        this.baseImg = document.getElementsByClassName(this.klass)[0];\n        this.img.src = this.baseImg.src;\n        this.attackImages = document.getElementsByClassName(this.klass);\n        this.container = entityContainer;\n        this.container.style.opacity = 0; // fading in so started at op 0\n        this.img.style.display = \"\";\n        this.container.style.left = this.pos[0] + \"px\";\n        this.container.style.top = this.pos[1] + \"px\";\n        this.hotkeyDisplay = hotkeyDisplay;\n        this.hotkey = document.getElementById(this.imgName + '-keybind').value;\n        this.hotkeyDisplay.innerHTML = this.hotkey;\n        this.hpContainerLeft = leftBar;\n        this.hpContainerRight = rightBar;\n        if (this.allied) {\n            this.abilityContainer = document.getElementById(this.imgName + '-ability-full-container');\n        }\n    }\n\n    setLevel(level) {\n        this.level = level;\n        this.baseDefense = Math.floor(this.baseDefense + Math.ceil(this.trueBaseDefense * 0.05) * (level - 1));\n        if (this.baseDMG > 0) {\n            this.baseDMG = Math.floor(this.baseDMG + Math.ceil(this.trueBaseDMG * 0.1) * (level - 1));\n        } else {\n            this.baseDMG = Math.ceil(this.baseDMG + Math.floor(this.trueBaseDMG * 0.1) * (level - 1));\n        }\n        this.baseHP = Math.floor(this.baseHP + Math.ceil(this.trueBaseHp * 0.1) * (level - 1));\n        // console.log(this.klass);\n        // console.log(this.baseDMG);\n        // console.log(this.level);\n        if (this.allied) {\n            this.nextLevelXP = Math.ceil(this.nextLevelXP + (this.nextLevelXP * 0.1) * (level - 1));\n            // this.nextLevelXP += (this.nextLevelXP * 0.1);\n            if (this.level > 15) {\n                this.abilities = this.allAbilities;\n            } else if (this.level > 11) {\n                this.abilities = [this.allAbilities[0], this.allAbilities[1], this.allAbilities[2]];\n            } else if (this.level > 7) {\n                this.abilities = [this.allAbilities[0], this.allAbilities[1]];\n            } else if (this.level > 3) {\n                this.abilities = [this.allAbilities[0]];\n            }\n        }\n        if (this.allied && this.imgName) {\n            this.xp = 1;\n            const levelUpDisp = document.getElementById(this.imgName + '-level-up');\n            levelUpDisp.style.display = '';\n            fastFadeOut(levelUpDisp);\n        }\n    }\n\n    vectorToScalar(endPos) {\n        const deltaX = this.pos[0] - endPos[0];\n        const deltaY = this.pos[1] - endPos[1];\n        if (Math.abs(deltaX) + Math.abs(deltaY) === 0) {\n            return ([0, 0, 0]);\n        }\n        let xChange = -1 * this.ms * (deltaX / (Math.abs(deltaX) + Math.abs(deltaY)));\n        let yChange = -1 * this.ms * (deltaY / (Math.abs(deltaY) + Math.abs(deltaX)));\n        if (xChange === 0 || xChange === -0) {\n            xChange = 0;\n            const numRepeats = Math.abs(Math.floor(deltaY / yChange));\n            return ([xChange, yChange, numRepeats])\n        }\n        if (yChange === -0) {\n            yChange = 0;\n        }\n        \n        const numRepeats = Math.abs(Math.floor(deltaX / xChange));\n        return ([xChange, yChange, numRepeats])\n    }\n\n    move(endPos, attackOnFinish = false, addXPBar=false, lockedIn=false) {\n        this.movingOutTheWay = true;\n        this.clearIntervals();\n        this.isMoving = true;\n        endPos[0] = Math.floor(endPos[0] - (this.container.offsetWidth * (1/2)));\n        endPos[1] = Math.floor(endPos[1] - (this.container.offsetHeight * (1/2)));\n        let pos = this.pos;\n        let posChange = this.vectorToScalar(endPos);\n        // console.log(\"pos change on move\", posChange);\n        const bigDiv = document.getElementById('game-container');\n        const width = bigDiv.offsetWidth;\n        const height = bigDiv.offsetHeight;\n        if (pos[0] - endPos[0] < 0) {\n            this.img.style.transform = \"scaleX(1)\";\n        } else {\n            this.img.style.transform = \"scaleX(-1)\";\n        }\n        this.currentAction = setInterval(() => frame(this), 20);\n        function frame(self) {\n            if (!(self.lockedIntoAbility || self.stunned || self.rooted) || lockedIn) {\n                if (posChange[2] === 0) {\n                // close animation\n                    self.clearIntervals();\n                    self.lockedIntoAbility = false;\n                    self.movingOutTheWay = false;\n                    pos[0] = Math.floor(pos[0]); pos[1] = Math.floor(pos[1]);\n                    if (attackOnFinish) {\n                        // console.log('self in move end: ', self);\n                        self.autoAttack(attackOnFinish); // needs editing\n                    } else if (addXPBar) {\n                        // console.log('move ended');\n                        self.img.style.transform = \"scaleX(1)\";\n                        self.img.style.border = '5px solid gold';\n                    }\n                } else { // need to add something for if (attackOnFinish) then update move destination to be the target's new position (with the modifiers)\n                // begin some kind of animation\n                    pos[0] += posChange[0]; pos[1] += posChange[1];\n                    if (pos[0] + Math.floor(self.container.offsetWidth) + 10 > width) { pos[0] = width - Math.floor(self.container.offsetWidth) - 10;}\n                    if (pos[0] < 10) {pos[0] = 10;}\n                    if (pos[1] + Math.floor(self.container.offsetHeight) + 10 > height) { pos[1] = height - Math.floor(self.container.offsetHeight) - 10;}\n                    if (pos[1] < 10) {pos[1] = 10;}\n                    // console.log('posChange: ', posChange);\n                    // console.log('pos: ', pos);\n    \n                    self.container.style.top = Math.floor(pos[1]) + 'px';\n                    self.container.style.left = Math.floor(pos[0]) + 'px';\n                    posChange[2] -= 1;\n                }\n            }\n        }\n    }\n\n    withinAttackRange(target) {\n        if (this.range === 'infinite') { return true; }\n        const widthAddition = Math.floor((this.img.width / 2) + (target.img.width / 2));\n        if (this.pos[0] > target.pos[0] - widthAddition - this.range && this.pos[0] < target.pos[0] + widthAddition + this.range) {\n            const heightAddition = Math.floor(this.img.height / 4);\n            if (this.pos[1] > target.pos[1] - heightAddition && this.pos[1] < target.pos[1] + heightAddition) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    killEntity(entity) {\n        // console.log(entity.klass, \"killed\");\n        self.lockedIntoAbility = false;\n        entity.clearIntervals();\n        if (entity.abilityContainer) { entity.abilityContainer.style.display = 'none'; }\n        entity.hp = -100;\n        entity.container.style.display = \"none\";\n    }\n\n    setHpBars() {\n        let leftWidth = Math.floor((this.hp / this.baseHP) * 100);\n        let rightWidth = 100 - leftWidth;\n        if (leftWidth < 0) leftWidth = 0;\n        if (rightWidth < 0) rightWidth = 0;\n        this.hpContainerLeft.style.width = leftWidth + '%';\n        this.hpContainerRight.style.width = rightWidth + '%';\n        let rightInnerWidth = Math.floor((this.tempHP / this.hp) * 100);\n        let leftInnerWidth = 100 - leftInnerWidth;\n        if (leftInnerWidth < 0) leftInnerWidth = 0;\n        if (rightInnerWidth < 0) rightInnerWidth = 0;\n        const innerLeftBar = document.getElementById(this.imgName + '-inner-leftHP-bar');\n        const innerTempBar = document.getElementById(this.imgName + '-inner-tempHP-bar');\n        innerLeftBar.style.width = leftInnerWidth + '%';\n        innerTempBar.style.width = rightInnerWidth + '%';\n    }\n\n    setTargetAndAttack() {\n        // console.log(this.klass, \"has finished attacking\", this.target.klass);\n\n        if (this.baseDMG > 0) {\n            this.enemies = shuffle(this.enemies);\n            for (let i = 0; i < this.enemies.length; i++) {\n                if (this.enemies[i].hp > 0) {\n                    this.target = this.enemies[i];\n                }\n            }\n            if (this.target.hp < 0) { return; }\n        } else {\n            this.allies = shuffle(this.allies);\n            for (let i = 0; i < this.allies.length; i++) {\n                if (this.allies[i].hp > 0) {\n                    this.target = this.allies[i];\n                }\n            }\n            if (this.target.hp < 0) { return; }\n        }\n        // console.log(this.klass, \"is now attacking\", this.target.klass);\n        this.autoAttack(this.target);\n    }\n\n    charactersStacked() {\n        for (let i = 0; i < this.allies.length; i++) {\n            if (!this.allies[i].movingOutTheWay && !(this.allies[i].img.style.display === 'none')) {                \n                const widthAddition = Math.floor(this.img.width / 2);\n                if (this.pos[0] > this.allies[i].pos[0] - widthAddition && this.pos[0] < this.allies[i].pos[0] + widthAddition) {\n                    const heightAddition = Math.floor(this.img.height / 2);\n                    if (this.pos[1] > this.allies[i].pos[1] - heightAddition && this.pos[1] < this.allies[i].pos[1] + heightAddition) {\n                        // console.log(this.klass, \"is moving to avoid\", this.allies[i].klass);\n                        return true;\n                    }\n                }\n            }\n        }\n        return false;\n    }\n\n    trackTarget(target, lockedIn=false) { // hot code\n        this.clearIntervals();\n        this.isMoving = true;\n        const bigDiv = document.getElementById('game-container');\n        const difference = Math.floor((window.innerWidth - bigDiv.offsetWidth) / 2);\n        const checker = difference + Math.floor(bigDiv.offsetWidth);\n        this.currentAction = setInterval(() => move(this), 20);\n        function move(self) {\n            if (!(self.lockedIntoAbility || self.stunned || self.rooted) || lockedIn) {\n                if (target.container.style.display === 'none') {\n                    self.clearIntervals();\n                    if (!self.allied) {\n                        self.setTargetAndAttack()\n                    }\n                    return;\n                }\n                if (self.withinAttackRange(target)) {\n                    clearInterval(self.currentAction);\n                    self.lockedIntoAbility = false;\n                    self.autoAttack(target);\n                    // console.log('auto attack called from track');\n                } else {\n                    const pos = self.pos;\n                    const movePos = target.pos.slice();\n                    if (pos[0] - movePos[0] < 0) {\n                        movePos[0] -= target.img.width;\n                        self.img.style.transform = \"scaleX(1)\";\n                    } else {\n                        movePos[0] += target.img.width;\n                        self.img.style.transform = \"scaleX(-1)\";\n                    }\n                    let posChange = self.vectorToScalar(movePos);\n                    pos[0] += posChange[0]; pos[1] += posChange[1];\n                    if (pos[0] + Math.floor(self.img.width) > checker) { pos[0] = checker - Math.floor(self.img.width); }\n                    if (pos[0] < 15) { pos[0] = 15; }\n                    if (pos[1] + Math.floor(self.img.height) > 850) { pos[1] = 850 - Math.floor(self.img.height); }\n                    if (pos[1] < 15) { pos[1] = 15; }\n                    self.container.style.top = Math.floor(pos[1]) + 'px';\n                    self.container.style.left = Math.floor(pos[0]) + 'px';\n                }\n            }\n        }\n    }\n\n    setOverlay(targetChar) {\n        // create div for overlay\n        let attackOverlay = document.createElement(\"div\");\n        attackOverlay.classList.add(targetChar.imgName.substr(0, 1) + \"-heal-overlay\");\n        document.getElementById(\"game-container\").appendChild(attackOverlay);\n        attackOverlay.style.top = (targetChar.pos[1] + 40) + 'px';\n        attackOverlay.style.left = targetChar.pos[0] + 'px';\n        attackOverlay.style.width = targetChar.img.width + 'px';\n        attackOverlay.style.height = targetChar.img.height + 'px';\n        const clearTime = Math.floor(this.as / 2);\n        // 50%op => 0%op over clearTime / 20\n        const iterations = clearTime / 20;\n        let opacity = 50;\n        const opSubtraction = opacity / iterations;\n        let timeCheck = 0;\n        let stackInterval = setInterval(() => {\n            attackOverlay.style.top = targetChar.pos[1] + 40 + 'px';\n            attackOverlay.style.left = targetChar.pos[0] + 'px';\n            opacity -= opSubtraction;\n            attackOverlay.style.opacity = opacity + '%';\n            timeCheck += 20;\n            if (timeCheck >= clearTime || targetChar.img.style.display === 'none') {\n                clearInterval(stackInterval);\n                attackOverlay.remove();\n            }\n        }, 20);\n    }\n\n    beginAttack(lockedIn=false) {\n        // make some kind of animation start\n        this.clearIntervals();\n        this.isAttacking = true;\n        if (this.allied) {\n            for (let i = 0; i < 4; i++) {\n                // console.log(this.abilityShouldCast[i]);\n                if (this.abilityShouldCast[i] === true) {\n                    this.abilityShouldCast[i] = false;\n                    this.useAbility(i);\n                }\n            }\n        }\n        this.currentAnimation = setInterval(() => this.animateAttack(lockedIn), Math.floor(this.as / 4))\n    }\n\n    animateAttack(lockedIn=false) {\n        if (!(this.lockedIntoAbility || this.stunned) || lockedIn) {\n            if (!this.target || this.target.hp <= 0) {\n                self.lockedIntoAbility = false;\n                this.clearIntervals();\n                if (!this.allied) {\n                    // chose another hero to attack\n                    this.setTargetAndAttack();\n                    // maybe add something in for player to auto target upon deaths ?\n                }\n                return;\n            }\n            if (this.target.pos[0] < this.pos[0]) {\n                this.img.style.transform = \"scaleX(-1)\";\n            } else {\n                this.img.style.transform = \"scaleX(1)\";\n            }\n            this.imgCycle += 1;\n            if (this.imgCycle === 3) {\n                if (this.extraAttackAnimation) {\n                    this.extraAttackAnimation(this, this.target);\n                }\n                if (this.allied) {\n                    for (let j = 0; j < 4; j++) {\n                        if (this.abilityShouldCast[j] === 1) {\n                            // console.log(this.klass);\n                            // console.log(this.abilityShouldCast[j]);\n                            this.useAbility(j);\n                        }\n                    }\n                }\n                this.attack(this.target);\n            }\n            if (!this.allied && this.baseDMG < 0) {\n                let lowest = 500;\n                let newTarg;\n                for (let i = 0; i < this.allies.length; i++) {\n                    if (this.allies[i].hp > 0 && this.allies[i].hp < lowest) {\n                        lowest = this.allies[i].hp;\n                        newTarg = this.allies[i];\n                    }\n                }\n                this.target = newTarg;\n            }\n            this.imgCycle = this.imgCycle % this.attackImages.length;\n            this.img.src = this.attackImages[this.imgCycle].src;\n        }\n    }\n\n    attack(target) {\n        if (!this.withinAttackRange(target)) {\n            this.trackTarget(target);\n            return;\n        } else {\n            if (this.dmg > 0) {\n                if (target.tempHP > 0) {\n                    target.tempHP -= this.dmg;\n                    if (target.tempHP < 0) {\n                        target.hp += target.tempHP;\n                        target.tempHP = 0;\n                    }\n                } else {\n                    target.hp -= (this.dmg * 15 / target.defense);\n                }\n                if (!target.isMoving && !target.isAttacking && target.allied && target.dmg > 0) {\n                    target.target = this;\n                    target.autoAttack(this);\n                }\n            } else {\n                target.hp -= this.dmg;\n            }\n            if (this.attackOverlay) {\n                if (this.attackOverlay === 1) {\n                    this.setOverlay(this);\n                } else {\n                    this.setOverlay(target);\n                }\n            }\n            if (target.hp > target.baseHP) { target.hp = target.baseHP; }\n            if (!target.allied && this.allied && target.baseDMG > 0 && this.defense > target.target.defense) {\n                target.target = this;\n                target.autoAttack(this);\n            }\n            target.setHpBars();\n\n            if (target.hp <= 0) {\n                this.killEntity(target);\n                if (!this.allied) {\n                    // chose another hero to attack\n                    this.setTargetAndAttack();\n                }\n            }\n            // console.log(\"border style: \", target.img.style.border);\n            if (target.img.style.border !== \"5px solid gold\") {\n                if (this.baseDMG > 0) {\n                    target.img.style.border = \"3px solid red\";\n                } else {\n                    target.img.style.border = \"3px solid green\";\n                } \n                setTimeout(() => {\n                    if (target && target.img.style.border !== \"5px solid gold\") {\n                        target.img.style.border = \"none\";\n                    }\n                }, 500);\n            }\n            if (this.range !== 'infinite' && this.charactersStacked()) {\n                this.movingOutTheWay = true;\n                const widthAddition = Math.floor(this.container.offsetWidth / 2);\n                const eWidthAddition = Math.floor(target.container.offsetWidth);\n                // const heightAddition = Math.floor(this.container.offsetHeight / 2);\n                const eHeightAddition = Math.floor(target.container.offsetHeight / 2);\n                if (this.img.style.transform === \"scaleX(-1)\") {\n                    // move to left side of target\n                    this.img.style.transform = \"scaleX(1)\";\n                    this.move([target.pos[0] - widthAddition, target.pos[1] + eHeightAddition], target)\n                } else {\n                    // move to right side of target;\n                    this.img.style.transform = \"scaleX(-1)\";\n                    this.move([target.pos[0] + (widthAddition + eWidthAddition), target.pos[1] + eHeightAddition], target)\n                }\n            }\n        }\n    }\n\n    autoAttack(targetChar) {\n        // console.log('auto attack target: ', targetChar);\n        this.target = targetChar;\n        if (this.withinAttackRange(targetChar)) {\n            if (this.pos[0] < targetChar.pos[0]) {\n                this.img.style.transform = \"scaleX(1)\";\n            } else {\n                this.img.style.transform = \"scaleX(-1)\";\n            }\n            this.beginAttack();\n        } else {\n            this.trackTarget(this.target);\n        }\n    }\n\n    clearIntervals() {\n        clearInterval(this.currentAction);\n        clearInterval(this.currentAnimation);\n        this.img.src = this.baseImg.src;\n        this.imgCycle = 0;\n        this.isAttacking = false;\n        this.isMoving = false;\n    }\n\n    useAbility(n) {\n        const ab = this.abilities[n];\n        if (this.abilityShouldCast[n] === 1) {\n            ab(this, this.target);\n            return;\n        } else if (!this.abilityAvailable[n] || this.abilities.length === 0) {\n            return;\n        }\n        // console.log('ability', n, 'attempted');\n        this.abilityAvailable[n] = false;\n        // console.log('ability: ', ab);\n        const cdTime = ab(this, this.target);\n        if (cdTime === false) {\n            // console.log('no target for ability');\n            this.abilityAvailable[n] = true;\n            return;\n        }\n        // console.log('seconds for ability cd: ', cdTime);\n        const innerBoxes = document.getElementsByClassName(this.imgName + '-inner-ability-divs');\n        colorFade(innerBoxes[n], cdTime, [255, 0, 0], [0, 0, 255]);\n        let CDTimer = setInterval(() => {\n            this.abilityAvailable[n] = true;\n            // console.log(this.imgName, ' ability ', n, ' off CD');\n            clearInterval(CDTimer);\n        }, (cdTime * 1000));\n    }\n\n}\n\nexport default Entity;\n\n\nfunction colorFade(element, time, start, end) {\n    element.style.border = 'none';\n    element.style.backgroundColor = 'rgb(' + start.toString() + ')';\n    let currentColor = start.slice();\n    const numIntervals = time * 5;\n    let deltaX = Math.floor((end[0] - start[0]) / numIntervals);\n    let deltaY = Math.floor((end[1] - start[1]) / numIntervals);\n    let deltaZ = Math.floor((end[2] - start[2]) / numIntervals);\n    let timeCount = 0;\n    let interval = setInterval(() => {\n        currentColor[0] += deltaX;\n        currentColor[1] += deltaY;\n        currentColor[2] += deltaZ;\n        element.style.backgroundColor = 'rgb(' + currentColor.toString() + ')';\n        timeCount++;\n        if (timeCount >= (time * 5)) {\n            element.style.backgroundColor = 'rgb(' + end.toString() + ')';\n            element.style.border = '5px solid gold';\n            // console.log('color fade complete');\n            clearInterval(interval);\n        }\n\n    }, 200);\n}\n\nfunction shuffle(a) {\n    for (let i = a.length - 1; i > 0; i--) {\n        const j = Math.floor(Math.random() * (i + 1));\n        [a[i], a[j]] = [a[j], a[i]];\n    }\n    return a;\n}\n\nfunction fastFadeOut(element, action = null) {\n    let op = 25;\n    let timerDown = setInterval(function () {\n        if (op <= 0) {\n            clearInterval(timerDown);\n            element.style.display = 'none';\n            if (action) { action(); }\n        }\n        element.style.opacity = op / 25;\n        op -= 1;\n        if (element.style.display === 'none') {\n            clearInterval(timerDown);\n            element.style.opacity = 0;\n        }\n    }, 25);\n}\n\nfunction fastFadeIn(element, action = null) {\n    let op = 0;\n    let timerUp = setInterval(function () {\n        if (op >= 20) {\n            clearInterval(timerUp);\n            if (action) { action(); }\n        }\n        element.style.opacity = op / 20;\n        op += 1;\n        if (element.style.display === 'none') {\n            clearInterval(timerUp);\n            element.style.opacity = 0;\n        }\n    }, 25);\n}","import loadLevel from './screen_controllers/entity_controller';\n\nlet db;\ndocument.addEventListener('DOMContentLoaded', (event) => {\n    db = firebase.firestore();\n})\n\n\nfunction slowFade(element, action = null) { let op = 80; let timerDown = setInterval(function () {if (op <= 0) { clearInterval(timerDown);\n    element.style.display = 'none'; if (action) { action(); } } element.style.opacity = op / 40; op -= 1;}, 50);}\n\nwindow.addEventListener('load', () => {\n    let dispLevelsScreenMessage = true;\n    let dispHeroesScreenMessage = true;\n    // let dispPartyScreenMessage = true;\n\n    const gameTag = document.getElementById('game-tag');\n    gameTag.style.opacity = 0;\n    gameTag.style.display = '';\n    \n    const charsDisp = document.getElementById('title-screen-chars');\n    const closeButton = document.getElementById('close-button');\n    const hButtons = document.getElementsByClassName('h-buttons')[0];\n    const hButton = document.getElementsByClassName('h-button');\n    const keybindContainer = document.getElementById('full-keybind-container');\n    const levelButtonContainer = document.getElementById('level-button-container');\n    const levelButtonHeader = document.getElementById(\"level-button-container-header\");\n    const statsContainer = document.getElementById('heroes-stats-full-container');\n    const levelButtons = document.getElementsByClassName('level-button');\n    const backgroundImage = document.getElementById('background-image');\n    const titleBackground = document.getElementById('title');\n    const gameContainer = document.getElementById('game-container');\n    const partySelectorContainer = document.getElementById('party-selector-container');\n    const storyContainer = document.getElementById('story-container');\n\n    const topRightAuthContainer = document.getElementById('full-auth-container');\n    const authButtonsContainer = document.getElementById('auth-container');\n    const loginButton = document.getElementById('login-button');\n    const signupButton = document.getElementById('signup-button');\n    const authShader = document.getElementById('auth-shader');\n    const authInputContainer = document.getElementById('auth-input-container');\n    const authSubmitButton = document.getElementById('auth-form-submit');\n    const authInputs = document.getElementsByClassName('auth-form-input');\n    const signedInDisplay = document.getElementById('auth-signedin-container');\n\n    function setDefaultSaveProfile(userId, dispName) {\n        const userDoc = db.collection('users').doc(userId);\n        userDoc.set({\n            name: dispName,\n            characters: {\n                \"Warrior\": {\n                    \"level\": 1,\n                    \"xp\": 0,\n                },\n                \"Cleric\": {\n                    \"level\": 1,\n                    \"xp\": 0,\n                },\n                \"Wizard\": {\n                    \"level\": 1,\n                    \"xp\": 0,\n                },\n                \"Rogue\": {\n                    \"level\": 1,\n                    \"xp\": 0,\n                },\n                \"Paladin\": {\n                    \"level\": 1,\n                    \"xp\": 0,\n                },\n                \"Berserker\": {\n                    \"level\": 1,\n                    \"xp\": 0,\n                },\n                \"Bard\": {\n                    \"level\": 1,\n                    \"xp\": 0,\n                },\n                \"Ranger\": {\n                    \"level\": 1,\n                    \"xp\": 0,\n                },\n                \"Warlock\": {\n                    \"level\": 1,\n                    \"xp\": 0,\n                }\n            },\n            party: [0, 1, 2, 3],\n            maxLevelNumber: 1,\n            storyPage: 0,\n            password: \"\",\n        })\n            .then(function() {\n                console.log(\"Document successfully written!\");\n                userDoc.get()\n                    .then(object => {\n                        const data = object.data();\n                        if (data && data.name) {\n                            console.log('Save history found!');\n                            // console.log(\"Save Data: \", data);\n                            loadLevel(null, data, userId);\n                        }\n                    })\n        })\n        .catch(function (error) {\n            console.error(\"Error finding document: \", error);\n        });\n    }\n\n    document.getElementById('google-button').addEventListener('click', () => {\n        const provider = new firebase.auth.GoogleAuthProvider();\n        firebase.auth().signInWithPopup(provider)\n            .then(result => {\n                const user = result.user;\n                const userDoc = db.collection('users').doc(user.uid);\n                userDoc.get()\n                    .then(object => {\n                        const data = object.data();\n                        // console.log('data: ', data);\n                        if (data && data.name) {\n                            console.log('Save history found!');\n                            // console.log(\"Save Data: \", data);\n                            loadLevel(null, data, user.uid, true);\n                            dispHeroesScreenMessage = false;\n                            dispLevelsScreenMessage = false;\n                        } else {\n                            console.log('No save data found -- creating new save');\n                            setDefaultSaveProfile(user.uid, user.displayName);\n                        }\n                    })\n                    .catch(err => {\n                        console.log(err);\n                    })\n            })\n            .catch(err => {console.log(err)})\n    })\n\n    function defaultsForAuth(username, length) {\n        if (username.length < length) { console.log('defaults failed'); return false; }\n        for (let i = 0; i < username.length; i++) {\n            if (username[i] === ' ') {\n                console.log('defaults failed');\n                return false;\n            }\n        }\n        return true;\n    }\n \n    function validSignup(username, password) {\n        const userDoc = db.collection('users').doc(username);\n            userDoc.get()\n                .then(object => {\n                    const data = object.data();\n                    if (data) {\n                        authFailedDisp(\"username-taken\");\n                    } else {\n                        setDefaultSaveProfile(username, username);\n                        try {\n                            db.collection('users').doc(username).update({\n                                password: password\n                            })\n                        } catch {\n                            console.log('failed to set password to new account');\n                        }\n                    }\n                })\n                .catch (err => {\n                    console.log(\"something went wrong\");\n                    authFailedDisp(\"invalid-login\");\n                })\n    }\n\n    function validDefaults(username, password) {\n        if (!defaultsForAuth(username, 4)) {\n            authFailedDisp(\"invalid-username\");\n            return false;\n        }\n        if (!defaultsForAuth(password, 6)) {\n            authFailedDisp(\"invalid-password\");\n            return false;\n        }\n        return true;\n    }\n\n    function validLogin(username, password) {\n        const userDoc = db.collection('users').doc(username);\n        userDoc.get()\n            .then(object => {\n                const data = object.data();\n                // console.log('data name: ', data.name);\n                if (data && data.name === username && data.password === password) {\n                    loadLevel(null, data, username, true);\n                    dispHeroesScreenMessage = false;\n                    dispLevelsScreenMessage = false;\n                } else {\n                    authFailedDisp(\"invalid-login\");\n                }\n            })\n            .catch(err => {\n                authFailedDisp(\"invalid-login\");\n                console.log('something went wrong');\n            })\n    }\n\n    function authFailedDisp(checker) {\n        const badInputDisp = document.getElementById('form-bad-input-disp');\n        if (checker === \"invalid-username\") {\n            badInputDisp.innerHTML = \"Username must be at least 4 characters long\";\n        } else if (checker === \"invalid-password\") {\n            badInputDisp.innerHTML = \"Password must be at least 6 characters long\";\n        } else if (checker === \"username-taken\") {\n            badInputDisp.innerHTML = \"Username has already been taken\";\n        } else if (checker === \"invalid-login\") {\n            badInputDisp.innerHTML = \"Invalid Username or Password\";\n        }\n        badInputDisp.style.display = '';\n    }\n\n    function loginAction(username, password) {\n        console.log('login attempted');\n        if (validDefaults(username, password)) {\n            validLogin(username, password);\n        }\n    }\n\n    function signupAction(username, password) {\n        console.log('signup attempted');\n        if (validDefaults(username, password)) {\n            validSignup(username, password);\n        }\n    }\n\n    authSubmitButton.addEventListener('click', (e) => {\n        e.preventDefault();\n        document.getElementById('form-bad-input-disp').style.display = 'none';\n        const username = authInputs[0].value.slice();\n        authInputs[0].value = '';\n        const password = authInputs[1].value.slice();\n        authInputs[1].value = '';\n\n        const formType = document.getElementById('form-name').innerHTML;\n        if (formType === 'Login') {\n            loginAction(username, password);\n        } else {\n            signupAction(username, password);\n        }\n    })\n\n    authShader.addEventListener('click', () => {\n        authShader.style.display = 'none';\n        authShader.style.opacity = '0%';\n        authInputContainer.style.display = 'none';\n        document.getElementById('form-bad-input-disp').style.display = 'none';\n    })\n    function animateShader(loadElement) {\n        let op = 0;\n        authShader.style.opacity = op + '%';\n        authShader.style.display = '';\n        let shaderInt = setInterval(() => {\n            if (authShader.style.display === 'none') {\n                clearInterval(shaderInt);\n                authShader.style.opacity = '0%';\n                authInputContainer.style.display = 'none';\n            }\n            // authShader.style.height = authShader.offsetHeight + (gameContainer.offsetHeight / 100);\n            op += 1;\n            authShader.style.opacity = op + '%';\n            if (op >= 80) {\n                clearInterval(shaderInt);\n                authInputContainer.style.display = '';\n                document.getElementById('form-name').innerHTML = loadElement;\n            }\n        }, 10);\n    }\n\n    loginButton.addEventListener('click', () => { animateShader(\"Login\"); })\n    signupButton.addEventListener('click', () => { animateShader(\"Signup\"); })\n\n    const shader = document.getElementById('first-description-shader');\n    const screenDescriptions = document.getElementsByClassName('screen-description');\n    shader.addEventListener('click', () => {\n        for (let i = 0; i < screenDescriptions.length; i++) {\n            screenDescriptions[i].style.display = 'none';\n        }\n        shader.style.display = 'none';\n    })\n\n    const keybindInputs = document.getElementsByClassName('keybind-input');\n    for (let i = 0; i < keybindInputs.length; i++) {\n        keybindInputs[i].addEventListener(\"change\", () => handleKeybindInput(keybindInputs[i], i));\n    }\n\n    function handleKeybindInput(input, i) {\n        // console.log('pre-mod: ', input.value);\n        if (input.value.length > 1) {\n            input.value = input.value[0];\n        } else {\n            for (let j = 0; j < keybindInputs.length; j++) {\n                if (i !== j && keybindInputs[j].value === input.value) { keybindInputs[j].value = ''; }\n            }\n        }\n    }\n\n    function secondAction() {\n        const gTContainer = document.getElementById('game-tag-container');\n        gTContainer.style.display = 'none';\n        function closeAction() {\n            // controlsContainer.style.display = 'none';\n            hButtons.style.display = '';\n            // controlsButton.style.display = '';\n            levelButtonHeader.style.display = 'none';\n            levelButtonContainer.style.display = 'none';\n            keybindContainer.style.display = 'none';\n            statsContainer.style.display = 'none';\n            closeButton.style.display = 'none';\n            partySelectorContainer.style.display = 'none';\n            storyContainer.style.display = 'none';\n            charsDisp.style.display = '';\n            backgroundImage.src = titleBackground.src;\n            backgroundImage.style.opacity = 100;\n            backgroundImage.style.height = '100vh';\n            backgroundImage.style.display = '';\n            topRightAuthContainer.style.display = '';\n        }\n        closeAction();\n        for (let i = 0; i < levelButtons.length; i++) {\n            levelButtons[i].addEventListener('click', () => { \n                closeButton.style.display = 'none';\n                // closeButton.removeEventListener('click', closeAction);\n                charsDisp.style.display = 'none';\n                backgroundImage.style.display = 'none';\n                gameContainer.style.height = '88%';\n                document.getElementById('background-image').style.height = gameContainer.offsetHeight + 'px';\n                document.getElementById('all-characters-ability-container').style.height = '12%';\n                loadLevel(i+1);\n            })\n        }\n        levelButtons[0].style.display = '';\n        levelButtons[0].style.opacity = 100;\n        levelButtons[0].style.cursor = 'pointer';\n        closeButton.addEventListener('click', closeAction)\n        let hButtonPartialAction = () => {\n            hButtons.style.display = 'none';\n            closeButton.style.display = '';\n            charsDisp.style.display = 'none';\n            backgroundImage.style.display = 'none';\n            topRightAuthContainer.style.display = 'none';\n        }\n        hButton[0].addEventListener('click', () => {\n            hButtonPartialAction();\n            if (hButton[3].style.display === '') {\n                storyContainer.style.display = '';\n            } else {\n                levelButtonContainer.style.display = '';\n                levelButtonHeader.style.display = '';\n            }\n            if (dispLevelsScreenMessage) {\n                document.getElementById('levels-screen-description').style.display = '';\n                shader.style.display = '';\n                dispLevelsScreenMessage = false;\n            }\n        })\n        hButton[1].addEventListener('click', () => {\n            hButtonPartialAction();\n            keybindContainer.style.display = '';\n        })\n        hButton[2].addEventListener('click', () => {\n            hButtonPartialAction();\n            statsContainer.style.display = '';\n            if (dispHeroesScreenMessage) {\n                document.getElementById('heroes-screen-description').style.display = '';\n                shader.style.display = '';\n                dispHeroesScreenMessage = false;\n            }\n        })\n        hButton[3].addEventListener('click', () => {\n            hButtonPartialAction();\n            partySelectorContainer.style.display = '';\n            // if (dispPartyScreenMessage) {\n            //     document.getElementById('party-screen-description').style.display = '';\n            //     shader.style.display = '';\n            //     dispPartyScreenMessage = false;\n            // }\n        })\n    }\n    slowFade(gameTag, secondAction);\n})","// import * as charactersObj from '../entities/character';\r\nimport charactersArr from '../entities/character';\r\nimport * as enemiesObj from '../entities/enemy';\r\n// console.log(enemiesObj);\r\n\r\nconst enemiesList = enemiesObj[\"allEnemies\"];\r\n\r\n// const charactersArr = Object.values(charactersObj);\r\nconst enemiesArr = Object.values(enemiesObj);\r\n// console.log(enemiesArr);\r\n\r\nconst classCreator = enemiesObj[\"classCreator\"];\r\n// test\r\nclass Level {\r\n    constructor(name, level, enemyList, message=\"\", actionChanges=()=>{}, shouldSetLevels=false, characterList=null) {\r\n        this.name = name;\r\n        this.level = level;\r\n        this.enemyList = enemyList;\r\n        this.message = message;\r\n        this.action = actionChanges;\r\n        this.characterList = characterList;\r\n        this.shouldSetLevels = shouldSetLevels;\r\n        // this.actionExpended = false;\r\n    }\r\n\r\n    setEnemyLevels(level) {\r\n        for (let i = 0; i < this.enemyList.length; i++) {\r\n            this.enemyList[i].setLevel(level);\r\n        }\r\n    }\r\n}\r\n\r\nfunction modP(width, percent) {\r\n    return (Math.floor(width * percent));\r\n}\r\n\r\nfunction applyMod(entity, mod, x = true) {\r\n    const container = document.getElementById('game-container');\r\n    const width = Math.floor(container.offsetWidth);\r\n    const height = Math.floor(container.offsetHeight);\r\n    if (x) {\r\n        entity.pos[0] = modP(width, (mod / 100));\r\n        entity.basePos[0] = entity.pos[0];\r\n    } else {\r\n        entity.pos[1] = modP(height, (mod / 100));\r\n        entity.basePos[1] = entity.pos[1];\r\n    }\r\n}\r\n\r\nconst defaultAction = (cArr, eArr) => {\r\n    // console.log(cArr, eArr);\r\n    applyMod(cArr[0], 60);\r\n    applyMod(cArr[1], 50);\r\n    applyMod(cArr[2], 40);\r\n    applyMod(cArr[3], 30);\r\n    applyMod(cArr[0], 25, false);\r\n    applyMod(cArr[1], 55, false);\r\n    applyMod(cArr[2], 25, false);\r\n    applyMod(cArr[3], 55, false);\r\n    return true;\r\n}\r\n\r\nconst tutorialActions = () => {\r\n    const cArr = charactersArr.slice(0, 4);\r\n    const eArr = enemiesArr.slice(0, 4);\r\n    applyMod(cArr[0], 35);\r\n    applyMod(cArr[1], 15);\r\n    applyMod(cArr[2], 15);\r\n    applyMod(cArr[3], 55);\r\n    applyMod(cArr[0], 55, false);\r\n    applyMod(cArr[1], 33, false);\r\n    applyMod(cArr[2], 66, false);\r\n    applyMod(cArr[3], 22, false);\r\n\r\n    applyMod(eArr[0][0], 55);\r\n    applyMod(eArr[0][0], 55, false);\r\n    applyMod(eArr[3][0], 55);\r\n    applyMod(eArr[3][1], 75);\r\n    applyMod(eArr[3][0], 55, false);\r\n    applyMod(eArr[3][1], 33, false);\r\n    applyMod(eArr[3][2], 75);\r\n    applyMod(eArr[3][2], 66, false);\r\n    applyMod(eArr[3][3], 35);\r\n    applyMod(eArr[3][3], 22, false);\r\n    return false;\r\n}\r\n\r\nconst actionFive = (cArr, eArr) => {\r\n    // WaCWiR\r\n    applyMod(cArr[0], 65);\r\n    applyMod(cArr[1], 45);\r\n    applyMod(cArr[2], 45);\r\n    applyMod(cArr[3], 25);\r\n    applyMod(cArr[0], 45, false);\r\n    applyMod(cArr[1], 25, false);\r\n    applyMod(cArr[2], 65, false);\r\n    applyMod(cArr[3], 45, false);\r\n    // WiRWaC\r\n    applyMod(eArr[0], 10);\r\n    applyMod(eArr[1], 15);\r\n    applyMod(eArr[2], 75);\r\n    applyMod(eArr[3], 80);\r\n    applyMod(eArr[0], 20, false);\r\n    applyMod(eArr[1], 65, false);\r\n    applyMod(eArr[2], 65, false);\r\n    applyMod(eArr[3], 20, false);\r\n    return false;\r\n}\r\nconst actionSix = (cArr, eArr) => {\r\n    // WaCWiR\r\n    applyMod(cArr[0], 60);\r\n    applyMod(cArr[1], 60);\r\n    applyMod(cArr[2], 30);\r\n    applyMod(cArr[3], 30);\r\n    applyMod(cArr[0], 60, false);\r\n    applyMod(cArr[1], 30, false);\r\n    applyMod(cArr[2], 30, false);\r\n    applyMod(cArr[3], 60, false);\r\n    // WiRWaC\r\n    applyMod(eArr[0], 5);\r\n    applyMod(eArr[1], 45);\r\n    applyMod(eArr[2], 45);\r\n    applyMod(eArr[3], 85);\r\n    applyMod(eArr[0], 45, false);\r\n    applyMod(eArr[1], 10, false);\r\n    applyMod(eArr[2], 70, false);\r\n    applyMod(eArr[3], 45, false);\r\n    return false;\r\n}\r\nconst actionSeven = (cArr, eArr) => {\r\n    applyMod(cArr[0], 50);\r\n    applyMod(cArr[1], 10);\r\n    applyMod(cArr[2], 35);\r\n    applyMod(cArr[3], 65);\r\n    applyMod(cArr[0], 20, false);\r\n    applyMod(cArr[1], 45, false);\r\n    applyMod(cArr[2], 60, false);\r\n    applyMod(cArr[3], 35, false);\r\n    applyMod(eArr[0], 25);\r\n    applyMod(eArr[1], 10);\r\n    applyMod(eArr[2], 80);\r\n    applyMod(eArr[3], 45);\r\n    applyMod(eArr[0], 15, false);\r\n    applyMod(eArr[1], 45, false);\r\n    applyMod(eArr[2], 45, false);\r\n    applyMod(eArr[3], 70, false);\r\n    return false;\r\n}\r\nconst actionEight = (cArr, eArr) => {\r\n    // WaCWiR\r\n    applyMod(cArr[0], 60);\r\n    applyMod(cArr[1], 60);\r\n    applyMod(cArr[2], 30);\r\n    applyMod(cArr[3], 30);\r\n    applyMod(cArr[0], 60, false);\r\n    applyMod(cArr[1], 30, false);\r\n    applyMod(cArr[2], 30, false);\r\n    applyMod(cArr[3], 60, false);\r\n    // WiRWaC\r\n    applyMod(eArr[0], 45);\r\n    applyMod(eArr[1], 10);\r\n    applyMod(eArr[2], 80);\r\n    applyMod(eArr[3], 45);\r\n    applyMod(eArr[0], 15, false);\r\n    applyMod(eArr[1], 45, false);\r\n    applyMod(eArr[2], 45, false);\r\n    applyMod(eArr[3], 70, false);\r\n    return false;\r\n}\r\n\r\nfunction makeRandomLevel(levelNum) {\r\n    const el = enemiesList.slice();\r\n    const enemies = [];\r\n    for (let i = 0; i < 4; i++) {\r\n        let idx = Math.floor(Math.random() * enemiesList.length);\r\n        if (idx > el.length) { idx++; }\r\n        const enemy = new classCreator(\r\n            el[idx].klass,\r\n            el[idx].range,\r\n            el[idx].trueBaseHp,\r\n            el[idx].baseMS,\r\n            el[idx].baseAS,\r\n            el[idx].trueBaseDMG,\r\n            el[idx].allied,\r\n            [0, 0],\r\n            el[idx].trueBaseDefense,\r\n            el[idx].attackOverlay,\r\n            el[idx].extraAttackAnimation,\r\n            null,\r\n            null\r\n        )\r\n        enemies.push(enemy); \r\n    }\r\n    const lev = new Level(`Level ${levelNum}`, levelNum, enemies, \"\", defaultAction, true);\r\n    return lev;\r\n}\r\n\r\n\r\nexport const levelZero = new Level('Zero', 0, enemiesList, \"\", null, false, charactersArr);\r\nexport const levelOne = new Level('Warrior', 1, enemiesArr[0],\r\n    \"Click on the stick figure, the warrior, in black to select it. Then click on the red stick figure enemy to attack it or click anywhere on the map to move there. Once an action is performed, the character will keep doing it until given a new action.\",\r\n    tutorialActions, false, [charactersArr[0]]);\r\nexport const levelTwo = new Level('Cleric', 2, enemiesArr[1],\r\n    \"The character with a staff is a cleric healer. Click on it and then on an allied unit or itself to begin healing them. De-select a character without making an action by clicking the Red button on the top right. Defeat all enemies to clear the level.\",\r\n    tutorialActions, false, [charactersArr[0], charactersArr[1]]);\r\nexport const levelThree = new Level('Wizard', 3, enemiesArr[2],\r\n    \"The character with the blue hat, the wizard, can attack enemies from any range. Click on it then on an enemy to begin attacking immediately. \\nAttacking an enemy with the Warrior will cause them to focus their attacks on him.\",\r\n    tutorialActions, false, [charactersArr[0], charactersArr[1], charactersArr[2]]);\r\nexport const levelFour = new Level('Rogue', 4, enemiesArr[3],\r\n    \"The newest character addition is the rogue with the daggers. Each character has a unique role. The Warrior is the best tank, the rogue the fastest attacker, the wizard the most versitile damage dealer, and the cleric the healer.\",\r\n    tutorialActions, false, [charactersArr[0], charactersArr[1], charactersArr[2], charactersArr[3]]);\r\nexport const levelFive = new Level('Level Five', 5, enemiesArr[4],\r\n    \"\",\r\n    actionFive);\r\nexport const levelSix = new Level('Magic', 6, enemiesArr[5], \"Wizards and Clerics\", actionSix);\r\nexport const levelSeven = new Level('Melee', 7, enemiesArr[6], \"All melee\", actionSeven);\r\nexport const levelEight = new Level('Doppel-ganger', 8, enemiesArr[7], \"Fight copies of yourself\", actionEight);\r\n// export const levelNine = new Level('Level Nine', 9, enemiesList.slice(1, 5), \"\", defaultAction, true);\r\n// export const levelTen = makeRandomLevel(10);","import * as levelsObj from '../levels/level';\r\nimport {fadeIn, fadeOut} from './fades';\r\n\r\nlet hasBeenLoaded = false;\r\nlet levelHasEnded = false;\r\n\r\nconst levels = Object.values(levelsObj);\r\nlet currentLevelNumber = 1;\r\nlet maxLevelNumber = 1;\r\nconst characters = levels[0].characterList.slice();\r\nlet partyIndexes = [0, 1, 2, 3];\r\nlet party = levels[4].characterList.slice();\r\n\r\nlet levelXPGain = 0;\r\n\r\nlet selectedChar;\r\n\r\nlet countToReach = 0;\r\nlet moveFinishCount = 0;\r\n\r\nlet livingEnemies = {};\r\nlet livingChars = {};\r\n\r\nlet currentAbilityBoxes;\r\n\r\nlet hotkeys = {};\r\n\r\nlet storyPage = 0;\r\n\r\nlet db;\r\nlet currentUserId;\r\n\r\nwindow.addEventListener('load', () => {\r\n    db = firebase.firestore();\r\n    let statChar1;\r\n    let statChar2;\r\n    let currentShowingAbilityDescription;\r\n    const heroStatcontainer = document.getElementById('heroes-button');\r\n    const heroStatsBlocks = document.getElementsByClassName('hero-stats');\r\n    const heroNameplateSelectors = document.getElementsByClassName('stat-selector');\r\n    const statSelectorNames = document.getElementsByClassName('stat-selector-name');\r\n    const statImages = document.getElementsByClassName('stats-img');\r\n    const statAbilities1 = document.getElementsByClassName('stat-ability-div-1');\r\n    const statAbilities2 = document.getElementsByClassName('stat-ability-div-2');\r\n    const abDescShader = document.getElementById('ability-description-shader');\r\n    const partySelectorButton = document.getElementById('party-button');\r\n    const partySelectorContainer = document.getElementById('party-selector-container');\r\n    const partySelectorNames = document.getElementsByClassName('party-selector-name');\r\n    const characterNameDisplays = document.getElementsByClassName('character-name-dispay');\r\n    for (let i = 1; i < levels.length; i++) {\r\n        let button = document.createElement(\"button\");\r\n        button.classList.add(\"level-button\");\r\n        button.id = `level-${i}-button`;\r\n        button.innerHTML = levels[i].name;\r\n        button.style.display = 'none';\r\n        document.getElementById(\"level-button-container\").appendChild(button);\r\n    }\r\n    abDescShader.addEventListener('click', () => {\r\n        if (currentShowingAbilityDescription) {\r\n            currentShowingAbilityDescription.style.display = 'none';\r\n            currentShowingAbilityDescription = null;\r\n        }\r\n        abDescShader.style.display = 'none';\r\n    })\r\n    function showAbilityDescription(side, num) {\r\n        let hero;\r\n        if (side === 1) {\r\n            hero = statChar1;\r\n        } else {\r\n            hero = statChar2;\r\n        }\r\n        currentShowingAbilityDescription = document.getElementById(hero.klass + '-ability-' + num + '-description-div');\r\n        currentShowingAbilityDescription.style.display = '';\r\n        abDescShader.style.display = '';\r\n    }\r\n    for (let i = 0; i < statAbilities1.length; i++) {\r\n        statAbilities1[i].addEventListener('click', () => showAbilityDescription(1, i+1));\r\n        statAbilities2[i].addEventListener('click', () => showAbilityDescription(2, i+1));\r\n    }\r\n    heroStatcontainer.addEventListener('click', () => {\r\n        for (let i = 0; i < statImages.length; i++) {\r\n            if (statImages[i].style.display !== 'none') {\r\n                let char; if (i === 0) { char = statChar1; } else { char = statChar2; }\r\n                const statImg = document.getElementById(`stats-img-${i + 1}`)\r\n                const nameStat = document.getElementById(`stats-name-${i + 1}`);\r\n                const levelStat = document.getElementById(`stats-level-${i + 1}`);\r\n                const hpStat = document.getElementById(`stats-hp-${i + 1}`);\r\n                const dmgStat = document.getElementById(`stats-dmg-${i + 1}`);\r\n                const defenseStat = document.getElementById(`stats-defense-${i + 1}`);\r\n                statImg.src = document.getElementsByClassName(char.klass)[0].src;\r\n                nameStat.innerHTML = char.klass;\r\n                levelStat.innerHTML = `Level: ${char.level}`;\r\n                hpStat.innerHTML = `Health: ${char.baseHP}`;\r\n                dmgStat.innerHTML = `Power: ${Math.abs(char.baseDMG)}`\r\n                defenseStat.innerHTML = `Defense: ${char.baseDefense}`;\r\n                for (let j = 0; j < statAbilities1.length; j++) {\r\n                    if (char.abilities[j]) {\r\n                        if (i === 0) {\r\n                            statAbilities1[j].style.display = '';\r\n                        } else { statAbilities2[j].style.display = ''; }\r\n                    } else {\r\n                        if (i === 0) {\r\n                            statAbilities1[j].style.display = 'none';\r\n                        } else { statAbilities2[j].style.display = 'none'; }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        for (let i = 0; i < statSelectorNames.length; i++) {\r\n            if (party[i]) {\r\n                statSelectorNames[i].innerHTML = party[i].klass;\r\n            }\r\n        }\r\n    })\r\n    partySelectorButton.addEventListener('click', () => {\r\n        for (let i = 0; i < characterNameDisplays.length; i++) {\r\n            if (characters[i]) {\r\n                characterNameDisplays[i].innerHTML = characters[i].klass;\r\n                characterNameDisplays[i].style.display = '';\r\n            } else {\r\n                characterNameDisplays[i].style.display = 'none';\r\n            }\r\n        }\r\n        for (let i = 0; i < partySelectorNames.length; i++) {\r\n            if (party[i]) {\r\n                partySelectorNames[i].innerHTML = party[i].klass;\r\n            }\r\n        }\r\n    })\r\n    let partyCharSelected = null;\r\n    let partyCharIdx = null;\r\n    for (let i = 0; i < characterNameDisplays.length; i++) {\r\n        characterNameDisplays[i].addEventListener('click', () => {\r\n            if (!partyCharSelected) {\r\n                for (let j = 0; j < partySelectorNames.length; j++) {\r\n                    partySelectorNames[j].style.cursor = 'pointer';\r\n                    partySelectorNames[j].addEventListener(\"mouseover\", addBlueBorder);\r\n                    partySelectorNames[j].addEventListener(\"mouseleave\", removeBlueBorder);\r\n                }\r\n            } else {\r\n                characterNameDisplays[partyCharIdx].style.border = '2px solid black';\r\n            }\r\n            characterNameDisplays[i].style.border = '5px solid red';\r\n            partyCharIdx = parseInt(characterNameDisplays[i].id.substr(characterNameDisplays[i].id.length - 1, 1))-1;\r\n            partyCharSelected = characters[partyCharIdx];\r\n        })\r\n    }\r\n    for (let i = 0; i < partySelectorNames.length; i++) {\r\n        partySelectorNames[i].addEventListener('click', () => {\r\n            if (!partyCharSelected) { return; }\r\n            partySelectorNames[i].style.cursor = 'default';\r\n            partySelectorNames[i].removeEventListener(\"mouseover\", addBlueBorder);\r\n            partySelectorNames[i].removeEventListener(\"mouseleave\", removeBlueBorder);\r\n            partySelectorNames[i].style.border = 'none';\r\n            for (let j = 0; j < party.length; j++) {\r\n                if (party[j].klass === partyCharSelected.klass) {\r\n                    partyIndexes[j] = partyIndexes[i];\r\n                    party[j] = party[i];\r\n                    partySelectorNames[j].innerHTML = party[j].klass;\r\n                    party[j].imgName = 'a' + (j+1);\r\n                    // party[j].addInlineStyle();\r\n                    // console.log(party);\r\n                }\r\n            }\r\n            partySelectorNames[i].innerHTML = partyCharSelected.klass;\r\n            partyIndexes[i] = partyCharIdx;\r\n            party[i] = partyCharSelected;\r\n            party[i].imgName = 'a' + (i+1);\r\n            // party[i].addInlineStyle();\r\n            characterNameDisplays[partyCharIdx].style.border = '2px solid black';\r\n            partyCharIdx = null;\r\n            partyCharSelected = null;\r\n            if (currentUserId) {\r\n                updatePartySave();\r\n            }\r\n        })\r\n    }\r\n\r\n    let shouldSwap = false;\r\n    let statCharSelected = null;\r\n    function swapStatDisp(e) {\r\n        if (!shouldSwap) { return; }\r\n        // console.log('swapping now');\r\n        e.currentTarget.style.border = '3px solid indigo';\r\n        e.currentTarget.style.cursor = 'default';\r\n        const sideCheck = e.currentTarget.id.substr(e.currentTarget.id.length-1);\r\n        for (let j = 0; j < heroStatsBlocks.length; j++) {\r\n            heroStatsBlocks[j].removeEventListener(\"mouseover\", addBlueBorder);\r\n            heroStatsBlocks[j].removeEventListener(\"mouseleave\", removeBlueBorder);\r\n        }\r\n        const charIndex = statCharSelected.id.substr(1, 1);\r\n        const char = party[charIndex-1];\r\n        \r\n        statCharSelected.style.border = 'none';\r\n        statCharSelected = null;\r\n\r\n        for (let j = 0; j < statAbilities1.length; j++) {\r\n            if (char.abilities[j]) {\r\n                if (parseInt(sideCheck) === 1) { statAbilities1[j].style.display = '';\r\n                } else { statAbilities2[j].style.display = ''; }\r\n            } else {\r\n                if (parseInt(sideCheck) === 1) { statAbilities1[j].style.display = 'none';\r\n                } else { statAbilities2[j].style.display = 'none'; }\r\n            }\r\n        }\r\n        \r\n        const tarId = e.target.id;\r\n        const sideNum = tarId.substr(tarId.length - 1, 1);\r\n        if (sideNum == 1) {\r\n            statChar1 = char;\r\n        } else {\r\n            statChar2 = char;\r\n        }\r\n        const statImg = document.getElementById(`stats-img-${sideNum}`)\r\n        const nameStat = document.getElementById(`stats-name-${sideNum}`);\r\n        const levelStat = document.getElementById(`stats-level-${sideNum}`);\r\n        const hpStat = document.getElementById(`stats-hp-${sideNum}`);\r\n        const dmgStat = document.getElementById(`stats-dmg-${sideNum}`);\r\n        const defenseStat = document.getElementById(`stats-defense-${sideNum}`);\r\n        if (statImg.style.display === 'none') { statImg.style.display = ''; }\r\n        statImg.src = document.getElementsByClassName(char.klass)[0].src;\r\n        nameStat.innerHTML = char.klass;\r\n        levelStat.innerHTML = `Level: ${char.level}`;\r\n        hpStat.innerHTML = `Health: ${char.baseHP}`;\r\n        dmgStat.innerHTML = `Power: ${Math.abs(char.baseDMG)}`\r\n        defenseStat.innerHTML = `Defense: ${char.baseDefense}`;\r\n\r\n        shouldSwap = false;\r\n    }\r\n    function addBlueBorder(e) {\r\n        e.currentTarget.style.border = '6px solid blue';\r\n        e.currentTarget.style.cursor = 'pointer';\r\n    } function removeBlueBorder(e) {\r\n        e.currentTarget.style.border = '3px solid indigo';\r\n        e.currentTarget.style.cursor = 'default';\r\n    }\r\n    function initiateStatSwap(e) {\r\n        // console.log('swap initiated');\r\n        if (shouldSwap) {\r\n            if (e.currentTarget === statCharSelected) { return; }\r\n            statCharSelected.style.border = 'none';\r\n            statCharSelected = e.currentTarget;\r\n            e.currentTarget.style.border = '4px solid blue';\r\n        } else {\r\n            statCharSelected = e.currentTarget;\r\n            statCharSelected.style.border = '4px solid blue';\r\n            for (let j = 0; j < heroStatsBlocks.length; j++) {\r\n                heroStatsBlocks[j].addEventListener(\"mouseover\", addBlueBorder);\r\n                heroStatsBlocks[j].addEventListener(\"mouseleave\", removeBlueBorder);\r\n            }\r\n            shouldSwap = true;\r\n        }\r\n    }\r\n    for (let j = 0; j < heroStatsBlocks.length; j++) { heroStatsBlocks[j].addEventListener(\"click\", swapStatDisp); }\r\n    for (let i = 0; i < heroNameplateSelectors.length; i++) { heroNameplateSelectors[i].addEventListener('click', initiateStatSwap); }\r\n})\r\n\r\n\r\n\r\n \r\nfunction addDeathListener(entity) {\r\n    entity.observer = new MutationObserver(function(mutations) {\r\n        mutations.forEach(function (mutationRecord) {\r\n            if (mutationRecord.target.style.display === 'none') {\r\n                // console.log(entity.imgName, 'style === none');\r\n                if (entity.allied) {\r\n                    delete livingChars[entity.imgName];\r\n                } else {\r\n                    levelXPGain += (livingEnemies[entity.imgName].level * 50);\r\n                    delete livingEnemies[entity.imgName];\r\n                }\r\n                const c = Object.values(livingChars);\r\n                const en = Object.values(livingEnemies);\r\n                if (c.length === 0 || en.length === 0) {\r\n                    if (!levelHasEnded) {\r\n                        // console.log('end game called');\r\n                        endGame(c, en, currentLevelNumber);\r\n                    }\r\n                    // console.log('game should have ended');\r\n                    levelHasEnded = true;\r\n                }\r\n            }\r\n        });\r\n    })\r\n}\r\n\r\nfunction createXPObserver(char) {\r\n    char.xpObserver = new MutationObserver(function (mutations) {\r\n        mutations.forEach(function (mutationRecord) {\r\n            if (char.observationToken && mutationRecord.target.style.border === '5px solid gold') {\r\n                moveFinishCount++;\r\n                char.observationToken = false;\r\n                // char.xpObserver.disconnect();\r\n                if (moveFinishCount === countToReach) {\r\n                    addCharXP();\r\n                }\r\n            }\r\n        })\r\n    })\r\n}\r\n\r\nfunction addEntityEvents(entity, allies, enemies) {\r\n    if (entity.imgName != \"\") {\r\n        if (!entity.observer) {\r\n            addDeathListener(entity);\r\n            if (entity.allied) {\r\n                createXPObserver(entity);\r\n            }\r\n        }\r\n        entity.enemies = enemies;\r\n        const cloneArr = allies.slice();\r\n        let selfIndex;\r\n        for (let i = 0; i < cloneArr.length; i++) {\r\n            if (cloneArr[i].imgName === entity.imgName) { selfIndex = i; }\r\n        }\r\n        // remove self from allies list to prevent moving out of self image (healers excluded)\r\n        if (entity.baseDMG > 0) { cloneArr.splice(selfIndex, 1); }\r\n        entity.allies = cloneArr;\r\n    } else {\r\n        console.log('broken image passed in for', entity.imgName);\r\n    }\r\n}\r\n\r\nfunction deSelect() {\r\n    // console.log('de-selected')\r\n    if (selectedChar) {\r\n        selectedChar.abilityContainer.style.display = 'none';\r\n        currentAbilityBoxes = null;\r\n        selectedChar.img.style.border = 'none';\r\n        selectedChar = null;\r\n    }\r\n}\r\n\r\nfunction styleAbilityBox(entity) {\r\n    const aBoxes = document.getElementsByClassName(entity.imgName + '-inner-ability-divs');\r\n    // const aLabels = document.getElementsByClassName(entity.imgName + '-ability-labels');\r\n    for (let i = 0; i < aBoxes.length; i++) {\r\n        aBoxes[i].style.width = aBoxes[i].offsetHeight + 'px';\r\n    }\r\n}\r\n\r\nfunction select(entity) {\r\n    entity.abilityContainer.style.display = '';\r\n    currentAbilityBoxes = entity.abilityContainer;\r\n    styleAbilityBox(entity);\r\n    entity.img.style.border = '5px solid gold';\r\n    selectedChar = entity;\r\n}\r\n\r\nfunction beginCurrentLevel() {\r\n    const beginLevelButton = document.getElementById('begin-level-button');\r\n    fadeOut(beginLevelButton);\r\n    const level = levels[currentLevelNumber];\r\n    beginLevel(level.characterList.slice(), level.enemyList.slice(), currentLevelNumber);\r\n}\r\n\r\nfunction returnToSelectPage() {\r\n    document.getElementById('game-container').style.height = '100%';\r\n    document.getElementById('background-image').style.height = document.getElementById('game-container').offsetHeight + 'px';\r\n    document.getElementById('all-characters-ability-container').style.height = '0%';\r\n    document.getElementById('return-button').style.display = 'none';\r\n    document.getElementById('tutorial-message').style.display = 'none';\r\n    document.getElementById(`level-name-display`).style.display = 'none';\r\n    document.getElementById('begin-level-button').style.display = 'none';\r\n    document.getElementById('level-button-container').style.display = '';\r\n    document.getElementById('level-button-container-header').style.display = '';\r\n    document.getElementById('close-button').style.display = '';\r\n}\r\n\r\nfunction selectChar(entity) {\r\n    if (!entity || entity.container.style.display === 'none' || entity.hp < 0) {\r\n        return;\r\n    }\r\n    if (selectedChar && selectedChar.baseDMG < 0) {\r\n        if (selectedChar.isAttacking) {\r\n            // console.log('no change. Target: ', selectedChar.target, ' entity: ', entity);\r\n            selectedChar.target = entity;\r\n        } else {\r\n            // console.log('heal target switched');\r\n            selectedChar.autoAttack(entity);\r\n        }\r\n        deSelect();\r\n        return;\r\n    }\r\n    deSelect();\r\n    select(entity);\r\n}\r\n\r\nfunction selectEnemy(entity) {\r\n    if (!selectedChar || selectedChar.hp < 0) {\r\n        deSelect();\r\n        return;\r\n    } else if ((selectedChar.target === entity && selectedChar.isAttacking) || (entity.hp && entity.hp < 0)) {\r\n        return;\r\n    }\r\n    if (selectedChar.allied && selectedChar.baseDMG > 0) {\r\n        if (selectedChar.isAttacking && selectedChar.withinAttackRange(entity)) {\r\n            selectedChar.target = entity;\r\n        } else {\r\n            selectedChar.autoAttack(entity);\r\n        }\r\n        for (let i = 0; i < selectedChar.abilities.length; i++) {\r\n            if (selectedChar.abilityShouldCast[i] === true) {\r\n                selectedChar.abilityShouldCast[i] = false;\r\n                selectedChar.useAbility(i);\r\n                // console.log('ability used on click event');\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nconst clickEvents = (e) => {\r\n    // console.log(e);\r\n    const entityName = e.target.id.slice(0, 2);\r\n    // console.log(entityName);\r\n    if (entityName[0] === 'a') {\r\n        const entity = livingChars[entityName];\r\n        selectChar(entity);\r\n    } else {\r\n        const entity = livingEnemies[entityName];\r\n        selectEnemy(entity);\r\n    }\r\n    e.stopPropagation();\r\n}\r\n\r\nfunction keydownEvent (e) {\r\n    const entity = hotkeys[e.key];\r\n    if (entity && entity.allied) {\r\n        selectChar(entity);\r\n    } else if (entity && entity.klass) {\r\n        selectEnemy(entity);\r\n    } else if ((entity === 0 || entity) && selectedChar) {\r\n        if (selectedChar.abilityShouldCast[entity] !== 1) {\r\n            selectedChar.useAbility(entity);\r\n        }\r\n    } else {\r\n        // console.log('invalid key press of: ', e.key);\r\n        // console.log('value is: ', entity);\r\n        // console.log(hotkeys);\r\n    }\r\n}\r\n\r\nfunction abilityClick(arr) {\r\n    const entity = livingChars['a'+arr[0]];\r\n    if (entity) {\r\n        if (entity.abilityShouldCast[arr[1]] !== 1) {\r\n            entity.useAbility(arr[1]);\r\n        }\r\n    } else {\r\n        // console.log('invalid entity for ability use');\r\n    }\r\n}\r\n\r\nfunction setAbilityBoxes() {\r\n    let abilityBoxes = [];\r\n    // let abilityLabels = [];\r\n    for (let i = 1; i < 5; i++) {\r\n        abilityBoxes.push(document.getElementsByClassName(`a${i}-inner-ability-divs`));\r\n        // abilityLabels.push(document.getElementsByClassName(`a${i}-ability-labels`));\r\n    }\r\n    for (let i = 0; i < abilityBoxes.length; i++) {\r\n        for (let j = 0; j < abilityBoxes[i].length; j++) {\r\n            abilityBoxes[i][j].addEventListener('click', () => abilityClick([i+1, j]));\r\n        }\r\n    }\r\n}\r\n\r\nfunction initializeGameOpening() {\r\n    document.getElementById('return-button').addEventListener('click', returnToSelectPage);\r\n    const deSelectButton = document.getElementById('test');\r\n    deSelectButton.addEventListener('click', deSelect);\r\n\r\n    const beginLevel = document.getElementById('begin-level-button');\r\n    beginLevel.addEventListener('click', beginCurrentLevel);\r\n\r\n    // end click position\r\n    const gameContainer = document.getElementById('game-container');\r\n    gameContainer.addEventListener(\"click\", (e) => {\r\n        // console.log(e);\r\n        if (selectedChar) {\r\n            if (selectedChar.hp < 0) {\r\n                deSelect();\r\n                return;\r\n            }\r\n            if (selectedChar.range === 'infinite') {\r\n                selectedChar.move([e.x, e.y], selectedChar.target);\r\n            } else {\r\n                selectedChar.move([e.x, e.y]);\r\n            }\r\n        }\r\n    })\r\n    window.addEventListener('keypress', (e) => {\r\n        // console.log(e);\r\n        keydownEvent(e);\r\n    })\r\n    setAbilityBoxes();\r\n\r\n    hasBeenLoaded = true;\r\n}\r\n\r\nfunction updatePartySave() {\r\n    try {\r\n        db.collection('users').doc(currentUserId).update({\r\n            party: partyIndexes,\r\n        })\r\n    } catch (err) {\r\n        console.log('Failed to update party save: ', err);\r\n    }\r\n}\r\n\r\nfunction updateUserScreen() {\r\n    const userDoc = db.collection('users').doc(currentUserId);\r\n    userDoc.update({\r\n        storyPage: storyPage,\r\n    })\r\n}\r\n\r\nfunction createCharSaveObj() {\r\n    const charsObj = {};\r\n    for (let i = 0; i < characters.length; i++) {\r\n        charsObj[characters[i].klass] = {};\r\n        charsObj[characters[i].klass][\"level\"] = characters[i].level;\r\n        charsObj[characters[i].klass][\"xp\"] = characters[i].xp;\r\n    }\r\n    return charsObj;\r\n}\r\nfunction updateCharObjects() {\r\n    const userDoc = db.collection('users').doc(currentUserId);\r\n    const charsObj = createCharSaveObj();\r\n    // console.log('generated chars obj: ', charsObj);\r\n    try {\r\n        userDoc.update({\r\n            characters: charsObj,\r\n        })\r\n    } catch (err) {\r\n        console.log('Char Object update failed with error: ', err);\r\n    }\r\n}\r\n\r\nfunction showStoryParts() {\r\n    if (maxLevelNumber > 8) {\r\n        document.getElementById('level-button-container').style.display = 'none';\r\n        document.getElementById('level-button-container-header').style.display = 'none';\r\n        document.getElementById('story-container').style.display = '';\r\n        document.getElementById('party-button').style.display = '';\r\n    }\r\n    setScreen(false);\r\n}\r\n\r\nfunction updateMaxLevel() {\r\n    showStoryParts();\r\n    if (maxLevelNumber > 8) {\r\n        document.getElementById('first-description-shader').style.display = '';\r\n        document.getElementById('tutorial-levels-finished-description').style.display = '';\r\n    }\r\n    try {\r\n        db.collection('users').doc(currentUserId).update({\r\n            maxLevelNumber: maxLevelNumber,\r\n        })\r\n    } catch (err) {\r\n        console.log('Failed to update max level: ', err);\r\n    }\r\n}\r\n\r\nfunction setPartyByIndexes() {\r\n    for (let i = 0; i < partyIndexes.length; i++) {\r\n        party[i] = characters[partyIndexes[i]];\r\n    }\r\n    // console.log('party set to: ', party);\r\n}\r\n\r\nfunction loadSaveData(saveData, userId, shouldInitWithPresets) {\r\n    document.getElementById('auth-container').style.display = 'none';\r\n    document.getElementById('auth-input-container').style.display = 'none';\r\n    document.getElementById('auth-shader').style.display = 'none';\r\n    document.getElementById('username-display').innerHTML = saveData.name;\r\n    document.getElementById('auth-signedin-container').style.display = '';\r\n    document.getElementById('form-bad-input-disp').style.display = 'none';\r\n    currentUserId = userId;\r\n    // console.log('User ID: ', currentUserId);\r\n    if (shouldInitWithPresets) {\r\n        try {\r\n            // console.log('Merging save data: ', saveData);\r\n            maxLevelNumber = saveData[\"maxLevelNumber\"];\r\n            storyPage = saveData[\"storyPage\"];\r\n            showStoryParts();\r\n            const levelButtons = document.getElementsByClassName('level-button');\r\n            for (let i = 1; i < maxLevelNumber; i++) {\r\n                if (i < levelButtons.length) {\r\n                    levelButtons[i].style.display = '';\r\n                    levelButtons[i].style.opacity = 100 + '%';\r\n                    levelButtons[i].style.cursor = 'pointer';\r\n                }\r\n            }\r\n            for (let i = 0; i < characters.length; i++) {\r\n                characters[i].xp = saveData[\"characters\"][characters[i].klass][\"xp\"];\r\n                characters[i].setLevel(saveData[\"characters\"][characters[i].klass][\"level\"]);\r\n            }\r\n            partyIndexes = saveData[\"party\"].slice();\r\n            setPartyByIndexes();\r\n        } catch (err) {\r\n            console.log('failed to attach save data to game state with err: ', err);\r\n        }\r\n    } else {\r\n        // console.log('Initializing save data to game state');\r\n        updateCharObjects();\r\n        updateMaxLevel();\r\n        updatePartySave();\r\n        updateUserScreen();\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\nfunction loadLevel(levelNumber, saveData=null, userId=null, shouldInitWithPresets=false) {\r\n    if (saveData) {\r\n        loadSaveData(saveData, userId, shouldInitWithPresets);\r\n        return;\r\n    }\r\n    if (!hasBeenLoaded) {\r\n        initializeGameOpening();\r\n    }\r\n    if (levelNumber > maxLevelNumber) {\r\n        document.getElementById('game-container').style.height = '100%';\r\n        document.getElementById('background-image').style.height = '100%';\r\n        document.getElementById('all-characters-ability-container').style.height = '0%';\r\n        return;\r\n    }\r\n    const level = levels[levelNumber];\r\n    if (level.characterList === null) {\r\n        level.characterList = party;\r\n    }\r\n    levelHasEnded = false;\r\n    currentLevelNumber = levelNumber;\r\n    const shouldRandomizeEnemySpawns = level.action(level.characterList, level.enemyList);\r\n    // console.log(shouldRandomizeEnemySpawns);\r\n    if (shouldRandomizeEnemySpawns) {\r\n        for (let i = 0; i < level.enemyList.length; i++) {\r\n            level.enemyList[i].basePos = null;\r\n            // console.log(level.enemyList[i]);\r\n        }\r\n    }\r\n    // console.log('level selected: ', levelNumber);\r\n    document.getElementById('return-button').style.display = '';\r\n    document.getElementById('level-button-container').style.display = 'none';\r\n    document.getElementById('level-button-container-header').style.display = 'none';\r\n    const levelNameDisp = document.getElementById(`level-name-display`);\r\n    levelNameDisp.innerHTML = level.name;\r\n    const levelMessage = document.getElementById('tutorial-message');\r\n    levelMessage.innerHTML = level.message;\r\n    // const secondAction = () => beginLevel(level.characterList, level.enemyList, levelNumber);\r\n    fadeIn(levelNameDisp);\r\n    // const levelNameAction = () => { fadeIn(beginLevel); }\r\n    const action = () => {\r\n        fadeOut(levelNameDisp);\r\n        fadeIn(beginLevel);\r\n    }\r\n    const beginLevel = document.getElementById('begin-level-button');\r\n    fadeIn(levelMessage, action);\r\n}\r\n\r\nfunction beginLevel(charactersArr, enemiesArr, levelNumber) {\r\n    document.getElementById('begin-level-button').style.display = 'none';\r\n    setInitialTargets(charactersArr, enemiesArr);\r\n    loadInCharacters(charactersArr, enemiesArr, levelNumber);\r\n}\r\n\r\nfunction setInitialTargets(chars, enemies) {\r\n    for (let i = 0; i < enemies.length; i++) {\r\n        if (enemies[i].baseDMG > 0) {\r\n            const targetIndex = Math.floor(Math.random() * chars.length);\r\n            enemies[i].target = chars[targetIndex];\r\n        } else {\r\n            const targetIndex = Math.floor(Math.random() * enemies.length);\r\n            enemies[i].target = enemies[targetIndex];\r\n        }\r\n        // console.log(enemies[i], \" has target set to: \", enemies[i].target);\r\n    }\r\n}\r\n\r\nfunction setAvailableAbilities(char) {\r\n    const abilities = document.getElementsByClassName(char.imgName + '-ability-boxes');\r\n    const boxes = document.getElementsByClassName(char.imgName + '-inner-ability-divs');\r\n    for (let i = 0; i < abilities.length; i++) {\r\n        if (i < char.abilities.length) {\r\n            abilities[i].style.display = '';\r\n            boxes[i].style.display = '';\r\n        } else {\r\n            abilities[i].style.display = 'none';\r\n            boxes[i].style.display = 'none';\r\n        }\r\n    }\r\n}\r\n\r\nfunction imagesTochingSide(topLeft1, sizes1, topLeft2, sizes2, i) {\r\n    return ((topLeft1[i] < topLeft2[i] && topLeft1[i] + sizes1[i] > topLeft2[i])\r\n        || (topLeft1[i] < topLeft2[i] + sizes2[i] && topLeft1[i] + sizes1[i] > topLeft2[i] + sizes2[i]));\r\n}\r\n\r\nfunction imagesTouching(topLeft1, sizes1, topLeft2, sizes2) {\r\n    if (topLeft1[0] === topLeft2[0] || topLeft1[1] === topLeft2[1]) { return true; }\r\n    for (let i = 0; i < 2; i++) {\r\n        if (!imagesTochingSide(topLeft1, sizes1, topLeft2, sizes2, i)) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\n\r\nfunction setRandomSpawn(enemy, checkPositions) {\r\n    // console.log(checkPositions);\r\n    let positionFound = false;\r\n    let position = [0, 0];\r\n    let p1;\r\n    let p2;\r\n    const container = document.getElementById('game-container');\r\n    const width = Math.floor(container.offsetWidth);\r\n    const height = Math.floor(container.offsetHeight);\r\n    while (!positionFound) {\r\n        positionFound = true;\r\n        p1 = Math.random() * 0.75; // from 0% to 90%\r\n        p2 = Math.random() * 0.8; // from 0% to 80%\r\n        // console.log(p);\r\n        position = [Math.floor(width * p2), Math.floor(height * p1)];\r\n        // console.log(position);\r\n        for (let i = 0; i < checkPositions.length; i++) {\r\n            const cPos = checkPositions[i].basePos;\r\n            const cSizes = [checkPositions[i].container.offsetWidth, checkPositions[i].container.offsetHeight];\r\n            // const eSizes = [enemy.container.offsetWidth, enemy.container.offsetHeight];\r\n            const eSizes = [150, 200]; // needs to be changed eventually for diff sized boxes\r\n            // console.log(position, eSizes, cPos, cSizes);\r\n            if (imagesTouching(position, eSizes, cPos, cSizes)) {\r\n                // console.log('position was bad');\r\n                positionFound = false;\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    // console.log('pos found');\r\n    enemy.basePos = position;\r\n    enemy.pos = position;\r\n    // enemy.container.style.left = enemy.pos[0] + 'px';\r\n    // enemy.container.style.top = enemy.pos[1] + 'px';\r\n}\r\n\r\nfunction reZeroStats(arr) {\r\n    for (let i = 0; i < arr.length; i++) {\r\n        arr[i].hp = arr[i].baseHP; arr[i].dmg = arr[i].baseDMG; arr[i].defense = arr[i].baseDefense;\r\n        arr[i].ms = arr[i].baseMS; arr[i].stunned = false; arr[i].rooted = false; arr[i].slowed = false;\r\n        arr[i].isAttacking = false; arr[i].isMoving = false;\r\n        if (arr[i].allied) {\r\n            arr[i].target = null;\r\n        }\r\n        if (arr[i].basePos) {\r\n            arr[i].pos[0] = arr[i].basePos[0]; arr[i].pos[1] = arr[i].basePos[1];\r\n        }\r\n    }\r\n}\r\n\r\nfunction loadInEntity(entity, num, allies, enemies) {\r\n    // console.log(entity);\r\n    if (entity.allied) {\r\n        entity.imgName = 'a' + (num);\r\n        livingChars[entity.imgName] = entity;\r\n    } else {\r\n        entity.imgName = 'e' + (num);\r\n        livingEnemies[entity.imgName] = entity;\r\n    }\r\n    addEntityEvents(entity, allies, enemies);\r\n    if (!entity.basePos) {\r\n        setRandomSpawn(entity, boxEntities.slice());\r\n    }\r\n    entity.addInlineStyle();\r\n    hotkeys[entity.hotkey] = entity;\r\n    entity.container.addEventListener('click', clickEvents);\r\n    boxEntities.push(entity);\r\n    if (entity.allied) {\r\n        document.getElementById(`a${num}-class-name`).innerHTML = entity.klass;\r\n        const abilityNames = document.getElementsByClassName(`a${num}-ability-labels`);\r\n        setAvailableAbilities(entity);\r\n        for (let j = 0; j < abilityNames.length; j++) {\r\n            if (entity.abilityNames[j]) {\r\n                abilityNames[j].innerHTML = entity.abilityNames[j];\r\n            } else {\r\n                abilityNames[j].innerHTML = 'No Ability';\r\n            }\r\n        }\r\n        fadeIn(entity.container);\r\n    } else {\r\n        // console.log(entity.target);\r\n        const action = () => entity.autoAttack(entity.target);\r\n        fadeIn(entity.container, action); // begin attacking target\r\n    }\r\n    observerObserve(entity);\r\n}\r\n\r\nlet boxEntities = [];\r\nfunction loadInCharacters(charactersArr, enemiesArr, levelNumber) {\r\n    document.getElementById('return-button').style.display = 'none';\r\n    const deSelectButton = document.getElementById('test');\r\n    fadeIn(deSelectButton);\r\n    const backgroundImg = document.getElementById('background-image');\r\n    if (levelNumber < 4) {\r\n        backgroundImg.src = document.getElementById('forest').src;\r\n    } else if (levelNumber < 7) {\r\n        backgroundImg.src = document.getElementById('snowy').src;\r\n    } else {\r\n        backgroundImg.src = document.getElementById('dungeon').src;\r\n    }\r\n    fadeIn(backgroundImg);\r\n    if (levels[levelNumber].shouldSetLevels) {\r\n        levels[levelNumber].setEnemyLevels(levels[levelNumber].level/2);\r\n    }\r\n    for (let i = 0; i < 4; i++) {\r\n        const abilityHotkey = document.getElementById(`ab${i + 1}-keybind`);\r\n        hotkeys[abilityHotkey.value] = i;\r\n    }\r\n    reZeroStats(charactersArr);\r\n    reZeroStats(enemiesArr);\r\n    for (let i = 0; i < charactersArr.length; i++) {\r\n        loadInEntity(charactersArr[i], i+1, charactersArr, enemiesArr);\r\n    }\r\n    // console.log(enemiesArr);\r\n    for (let i = 0; i < enemiesArr.length; i++) {\r\n        loadInEntity(enemiesArr[i], i+1, enemiesArr, charactersArr);\r\n    }\r\n    // console.log(\"hotkeys: \", hotkeys);\r\n}\r\n\r\nfunction observerObserve(entity) {\r\n    const element = entity.container;\r\n    entity.observer.observe(element, { attributes: true, attributeFilter: ['style'] });\r\n}\r\n\r\n\r\n\r\n\r\nfunction endGame(charsList, enemyList) {\r\n    hotkeys = {};\r\n    if (currentAbilityBoxes) {\r\n        currentAbilityBoxes.style.display = 'none';\r\n        currentAbilityBoxes = null;\r\n    }\r\n    const levelMessage = document.getElementById('tutorial-message');\r\n    levelMessage.style.display = 'none';\r\n    const deSelectButton = document.getElementById('test');\r\n    deSelectButton.style.display = 'none';\r\n    deSelect();\r\n    const projectiles = document.getElementsByClassName('projectile');\r\n    for (let i = 0; i < projectiles.length; i++) {\r\n        projectiles[i].display = 'none';\r\n    }\r\n    const allCharsList = levels[currentLevelNumber].characterList;\r\n    const allEnemyList = levels[currentLevelNumber].enemyList;\r\n    for (let i = 0; i < allCharsList.length; i++) {\r\n        allCharsList[i].observer.disconnect();\r\n        clearInterval(allCharsList[i].currentAction);\r\n        clearInterval(allCharsList[i].currentAnimation);\r\n        allCharsList[i].container.removeEventListener('click', clickEvents);\r\n        allCharsList[i].img.src = allCharsList[i].baseImg.src;\r\n    }\r\n    for (let i = 0; i < allEnemyList.length; i++) {\r\n        allEnemyList[i].observer.disconnect();\r\n        clearInterval(allEnemyList[i].currentAction);\r\n        clearInterval(allEnemyList[i].currentAnimation);\r\n        allEnemyList[i].container.removeEventListener('click', clickEvents);\r\n        allEnemyList[i].img.src = allEnemyList[i].baseImg.src;\r\n    }\r\n\r\n    if (charsList.length > 0) {\r\n        endMoveChars(charsList);\r\n    } else {\r\n        const backgroundImg = document.getElementById('background-image');\r\n        fadeOut(backgroundImg);\r\n        for (let i = 0; i < enemyList.length; i++) {\r\n            fadeOut(enemyList[i].container);\r\n        }\r\n        fadeOutGame(false);\r\n    }\r\n}\r\n\r\nfunction xpObserverObserve(char) {\r\n    char.observationToken = true;\r\n    char.xpObserver.observe(char.img, { attributes: true, attributeFilter: ['style'] });\r\n}\r\n\r\nfunction modEndPos() {\r\n    const container = document.getElementById('game-container');\r\n    const width = Math.floor(container.offsetWidth);\r\n    const height = Math.floor(container.offsetHeight);\r\n    const widthExtra = width - (160 * 4);\r\n    return ([Math.floor(widthExtra / 4), Math.floor(height * 0.66), Math.floor(width/10)]);\r\n}\r\n\r\nfunction endMoveChars(charsList) {\r\n    moveFinishCount = 0;\r\n    countToReach = charsList.length;\r\n    const basePos = modEndPos(); // make into % values\r\n    for (let i = 0; i < charsList.length; i++) {\r\n        xpObserverObserve(charsList[i]);\r\n        charsList[i].move([(i*160) + ((i+1)*basePos[0]), basePos[1]], false, true); // removed + basePos[2] from x side\r\n    }\r\n}\r\n\r\nfunction addCharXP() {\r\n    const c = Object.values(livingChars);\r\n    // console.log(c);\r\n    for (let i = 0; i < c.length; i++) {\r\n        c[i].xpObserver.disconnect();\r\n        const expWords = document.getElementById(c[i].imgName + '-exp-words');\r\n        expWords.innerHTML = 'Level: ' + c[i].level;\r\n        const leftBar = document.getElementById(c[i].imgName + '-inner-leftHP-bar');\r\n        leftBar.style.backgroundColor = 'gold';\r\n        const xpPercent = Math.floor((c[i].xp / c[i].nextLevelXP) * 100);\r\n        c[i].hpContainerLeft.style.width = `${xpPercent}%`;\r\n        c[i].hpContainerRight.style.width = `${100 - xpPercent}%`;\r\n        const levelUpDisp = document.getElementById(c[i].imgName + '-level-up');\r\n        levelUpDisp.style.top = Math.floor(c[i].pos[1] - 75) + 'px';\r\n        levelUpDisp.style.left = Math.floor(c[i].pos[0]) + 'px';\r\n    }\r\n    fadeOutGame(true);\r\n    const xpPerC = levelXPGain / c.length;\r\n    const xpPerInterval = xpPerC / 60; // 4 seconds for the animation, .05 sec intervals\r\n    let timeCount = 0;\r\n    const xpInterval = setInterval(() => {\r\n        if (timeCount === 60) {\r\n            clearInterval(xpInterval);\r\n            for (let i = 0; i < c.length; i++) {\r\n                c[i].xp = Math.ceil(c[i].xp);\r\n                // console.log('xp: ', c[i].xp, ' level: ', c[i].level);\r\n                c[i].container.style.border = 'none';\r\n                fadeOut(c[i].container);\r\n            }\r\n            if (currentUserId) {\r\n                updateCharObjects();\r\n            }\r\n            const backgroundImg = document.getElementById('background-image');\r\n            fadeOut(backgroundImg);\r\n        }\r\n        for (let i = 0; i < c.length; i++) {\r\n            c[i].xp += xpPerInterval;\r\n            if (c[i].xp > c[i].nextLevelXP) {\r\n                c[i].setLevel(c[i].level + 1);\r\n                const expWords = document.getElementById(c[i].imgName + '-exp-words');\r\n                expWords.innerHTML = 'Level: ' + c[i].level;\r\n            }\r\n            const xpPercent = Math.floor((c[i].xp / c[i].nextLevelXP) * 100);\r\n            c[i].hpContainerLeft.style.width = `${xpPercent}%`;\r\n            c[i].hpContainerRight.style.width = `${100 - xpPercent}%`;\r\n        }\r\n        timeCount++;\r\n    }, 50);\r\n}\r\n\r\nfunction fadeOutGame(won) {\r\n    let theThing = (actionIterations) => {\r\n        if (!actionIterations) {\r\n            actionIterations = 40;\r\n        }\r\n        // console.log('fade called');\r\n        let disp;\r\n        let secondAction;\r\n        if (!won) {\r\n            disp = document.getElementById('game-over-display');\r\n            secondAction = () => resetGame(false);\r\n        } else {\r\n            disp = document.getElementById('game-won-display');\r\n            secondAction = () => resetGame(true);\r\n        }\r\n        disp.style.opacity = 0;\r\n        disp.style.display = '';\r\n        const action = () => fadeOut(disp, secondAction, actionIterations);\r\n        fadeIn(disp, action);\r\n    }\r\n    if (!won) {\r\n        setTimeout(theThing, 2000);\r\n    } else {\r\n        theThing(60);\r\n    }\r\n}\r\n\r\nfunction resetGame(won) {\r\n    livingChars = {};\r\n    livingEnemies = {};\r\n    document.getElementById('level-button-container').style.display = '';\r\n    document.getElementById('level-button-container-header').style.display = '';\r\n    document.getElementById('close-button').style.display = '';\r\n    document.getElementById('game-container').style.height = '100%';\r\n    document.getElementById('background-image').style.height = document.getElementById('game-container').offsetHeight + 'px';\r\n    document.getElementById('all-characters-ability-container').style.height = '0%';\r\n    const levelButtons = document.getElementsByClassName('level-button');\r\n    if (won && maxLevelNumber === currentLevelNumber) {\r\n        if (levelButtons[maxLevelNumber]) {\r\n            levelButtons[maxLevelNumber].style.display = '';\r\n            levelButtons[maxLevelNumber].style.opacity = 100 + '%';\r\n            levelButtons[maxLevelNumber].style.cursor = 'pointer';\r\n            document.getElementById('level-button-container').style.display = 'none';\r\n            document.getElementById('story-container').style.display = '';\r\n        }\r\n        maxLevelNumber++;\r\n        if (currentUserId) {\r\n            updateMaxLevel();\r\n        } else {\r\n            showStoryParts();\r\n            if (maxLevelNumber > 8) {\r\n                document.getElementById('first-description-shader').style.display = '';\r\n                document.getElementById('tutorial-levels-finished-description').style.display = '';\r\n            }\r\n        }\r\n    }\r\n    const levChars = levels[currentLevelNumber].characterList;\r\n    const levEnems = levels[currentLevelNumber].enemyList;\r\n    for (let i = 0; i < levChars.length; i++) {\r\n        levChars[i].container.remove();\r\n    }\r\n    for (let i = 0; i < levEnems.length; i++) {\r\n        levEnems[i].container.remove();\r\n    }\r\n    levelXPGain = 0;\r\n    boxEntities = [];\r\n}\r\n\r\nexport default loadLevel;\r\n\r\nfunction prevScreenAvailable() {\r\n    if (storyPage === 0) {\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\n\r\nfunction nextScreenAvailable() {\r\n    const storyElements = document.getElementsByClassName('story-page');\r\n    if (storyPage === storyElements.length - 1) {\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\n\r\nfunction setScreen(e) {\r\n    // console.log(e.currentTarget);\r\n    const storyElements = document.getElementsByClassName('story-page');\r\n    const nextScreenButton = document.getElementById('next-page-button');\r\n    const prevScreenButton = document.getElementById('prev-page-button');\r\n    const storyContainer = document.getElementById('story-container');\r\n    const levelButtonContainer = document.getElementById('level-button-container');\r\n    const levelButtonHeader = document.getElementById('level-button-container-header');\r\n    if (e) {\r\n        storyElements[storyPage].style.display = 'none';\r\n        if (e.currentTarget.id.substr(0, 1) === 'n') {\r\n            storyPage++;\r\n        } else {\r\n            storyPage--;\r\n        }\r\n        if (currentUserId) {\r\n            updateUserScreen();\r\n        }\r\n    }\r\n    storyElements[storyPage].style.display = '';\r\n    if (document.getElementById('party-selector-container').style.display === 'none') {\r\n        if (currentLevelNumber === storyPage) {\r\n            storyContainer.style.display = 'none';\r\n            levelButtonContainer.style.display = '';\r\n            levelButtonHeader.style.display = '';\r\n        }\r\n    }\r\n    if (prevScreenAvailable()) {\r\n        prevScreenButton.style.display = '';\r\n    } else {\r\n        prevScreenButton.style.display = 'none';\r\n    }\r\n    if (nextScreenAvailable()) {\r\n        nextScreenButton.style.display = '';\r\n    } else {\r\n        nextScreenButton.style.display = 'none';\r\n    }\r\n}\r\n\r\nwindow.addEventListener('load', () => {\r\n    \r\n    const storyContainer = document.getElementById('story-container');\r\n    const nextScreenButton = document.getElementById('next-page-button');\r\n    const prevScreenButton = document.getElementById('prev-page-button');\r\n    const openPartyScreenButton = document.getElementById('open-party-interface');\r\n\r\n    nextScreenButton.addEventListener('click', (e) => { setScreen(e); })\r\n    prevScreenButton.addEventListener('click', (e) => { setScreen(e); })\r\n\r\n    const characterNameDisplays = document.getElementsByClassName('character-name-dispay');\r\n    const partySelectorNames = document.getElementsByClassName('party-selector-name');\r\n    openPartyScreenButton.addEventListener('click', () => {\r\n        for (let i = 0; i < characterNameDisplays.length; i++) {\r\n            if (characters[i]) {\r\n                characterNameDisplays[i].innerHTML = characters[i].klass;\r\n                characterNameDisplays[i].style.display = '';\r\n            } else {\r\n                characterNameDisplays[i].style.display = 'none';\r\n            }\r\n        }\r\n        for (let i = 0; i < partySelectorNames.length; i++) {\r\n            if (party[i]) {\r\n                partySelectorNames[i].innerHTML = party[i].klass;\r\n            }\r\n        }\r\n        storyContainer.style.display = 'none';\r\n        document.getElementById('party-selector-container').style.display = '';\r\n        document.getElementById('party-screen-description').style.display = '';\r\n        document.getElementById('first-description-shader').style.display = '';\r\n    })\r\n})","export function fadeOut(element, action = null, iterations=40) {\r\n    let op = iterations;\r\n    let timerDown = setInterval(function () {\r\n        if (op <= 0) {\r\n            clearInterval(timerDown);\r\n            element.style.display = 'none';\r\n            if (action) { action(); }\r\n        }\r\n        element.style.opacity = op / iterations;\r\n        op -= 1;\r\n        if (element.style.display === 'none') {\r\n            clearInterval(timerDown);\r\n            element.style.opacity = 0;\r\n        }\r\n    }, 50);\r\n}\r\n\r\nexport function fadeIn(element, action = null, iterations=40) {\r\n    element.style.opacity = 0;\r\n    element.style.display = '';\r\n    let op = 0;\r\n    let timerUp = setInterval(function () {\r\n        if (op >= iterations) {\r\n            clearInterval(timerUp);\r\n            if (action) { action(); }\r\n        }\r\n        element.style.opacity = op / iterations;\r\n        op += 1;\r\n        if (element.style.display === 'none') {\r\n            clearInterval(timerUp);\r\n            element.style.opacity = 0;\r\n        }\r\n    }, 50);\r\n}"],"sourceRoot":""}